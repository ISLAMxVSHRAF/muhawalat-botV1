<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Ù…Ø­Ø§ÙˆÙ„Ø§Øª â€” Ø¨Ø±ÙˆÙØ§ÙŠÙ„ÙŠ</title>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       VARIABLES â€” Neo-Brutalism + Premium Gamification
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root {
      --bg:      #0C090D;
      --surface: #0F0C10;
      --slate:   #7286A0;
      --tomato:  #F15946;
      --sun:     #F9C22E;
      --green:   #3DD68C;
      --cream:   #FBFEFB;
      --border:  rgba(251,254,251,.08);
      --border-hi: rgba(251,254,251,.14);
      --muted:   rgba(251,254,251,.35);
      --dim:     rgba(251,254,251,.12);
    }
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'IBM Plex Sans Arabic', sans-serif;
      background: var(--bg);
      color: var(--cream);
      min-height: 100dvh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
    }
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      opacity: .03;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREENS â€” ØªØ­Ù…ÙŠÙ„ / Ø§Ù†ØªÙ‡Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #screen-load, #screen-inv {
      position: fixed;
      inset: 0;
      z-index: 200;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 24px;
      background: var(--bg);
    }
    #screen-inv {
      display: none;
      border: 1px solid rgba(251,254,251,.06);
      box-shadow: inset 0 0 80px rgba(0,0,0,.4);
    }
    .s-logo {
      width: 64px;
      height: 64px;
      background: var(--tomato);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      box-shadow: 0 0 40px rgba(241,89,70,.25);
      animation: logoPulse 2.5s ease-in-out infinite;
    }
    @keyframes logoPulse {
      0%, 100% { box-shadow: 0 0 30px rgba(241,89,70,.2); }
      50%      { box-shadow: 0 0 50px rgba(241,89,70,.4); }
    }
    .s-spin {
      width: 24px;
      height: 24px;
      border: 2px solid var(--border);
      border-top-color: var(--tomato);
      border-radius: 50%;
      animation: spin .8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .s-txt { font-size: 12px; color: var(--muted); font-weight: 500; }
    .inv-icon { font-size: 64px; margin-bottom: 8px; opacity: .9; }
    .inv-title { font-size: 24px; font-weight: 800; letter-spacing: -.5px; }
    .inv-sub {
      font-size: 13px;
      color: var(--muted);
      text-align: center;
      max-width: 300px;
      line-height: 1.75;
      margin-top: 8px;
    }
    .inv-title { text-shadow: 0 0 24px rgba(241,89,70,.15); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCROLL PROGRESS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #scroll-progress {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 150;
      height: 2px;
      background: transparent;
      pointer-events: none;
    }
    #scroll-fill {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--tomato), var(--sun));
      box-shadow: 0 0 10px rgba(241,89,70,.5);
      transition: width .06s linear;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       BENTO GRID â€” Player Card
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #app {
      display: none;
      position: relative;
      z-index: 1;
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 20px 80px;
    }
    .bento {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-auto-rows: minmax(100px, auto);
      gap: 14px;
    }
    .cell {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 20px;
      transition: border-color .25s ease, box-shadow .25s ease;
      overflow: hidden;
    }
    .cell:hover {
      border-color: rgba(251,254,251,.12);
      box-shadow: inset 0 0 40px rgba(241,89,70,.03);
    }
    .cell-identity   { grid-column: span 1; grid-row: span 2; }
    .cell-streak     { grid-column: span 1; grid-row: span 2; }
    .cell-goals      { grid-column: span 2; grid-row: span 1; }
    .cell-habits     { grid-column: span 2; grid-row: span 2; }
    .cell-chart      { grid-column: span 2; grid-row: span 1; }
    .cell-challenges { grid-column: span 2; grid-row: span 1; }
    .cell-activity   { grid-column: span 2; grid-row: span 1; }
    .cell-ach        { grid-column: span 2; grid-row: span 2; }
    .cell-lb         { grid-column: span 2; grid-row: span 1; }

    .cell-title {
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .cell-title::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
    }

    /* â”€â”€â”€ Identity â”€â”€â”€ */
    .identity-inner { display: flex; flex-direction: column; align-items: center; text-align: center; }
    .id-avatar {
      width: 72px;
      height: 72px;
      border-radius: 16px;
      background: rgba(241,89,70,.12);
      border: 1px solid rgba(241,89,70,.25);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      font-weight: 900;
      color: var(--tomato);
      margin-bottom: 14px;
      box-shadow: 0 0 24px rgba(241,89,70,.15);
      animation: avatarPulse 3s ease-in-out infinite;
    }
    @keyframes avatarPulse {
      0%, 100% { box-shadow: 0 0 20px rgba(241,89,70,.12); }
      50%      { box-shadow: 0 0 32px rgba(241,89,70,.25); }
    }
    .id-name { font-size: 18px; font-weight: 800; letter-spacing: -.4px; margin-bottom: 10px; }
    .id-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(249,194,46,.1);
      border: 1px solid rgba(249,194,46,.25);
      color: var(--sun);
      font-size: 11px;
      font-weight: 700;
      padding: 6px 14px;
      border-radius: 100px;
      margin-bottom: 14px;
      box-shadow: 0 0 16px rgba(249,194,46,.08);
    }
    .id-freeze {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 600;
    }
    .id-freeze span { color: var(--cream); }
    .id-meta { font-size: 11px; color: var(--muted); margin-top: 8px; line-height: 1.6; }
    .id-meta .id-join { display: block; margin-bottom: 4px; }
    .id-warnings {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-weight: 700;
      padding: 4px 10px;
      border-radius: 8px;
      margin-top: 6px;
    }
    .id-warnings.zero { background: rgba(255,255,255,.06); color: var(--muted); border: 1px solid var(--border); }
    .id-warnings.has { background: rgba(241,89,70,.15); color: var(--tomato); border: 1px solid rgba(241,89,70,.35); }
    .id-reviews { font-size: 11px; color: var(--muted); margin-top: 6px; }
    .id-reviews span { color: var(--cream); font-weight: 700; }

    /* â”€â”€â”€ Streak Fire â”€â”€â”€ */
    .streak-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100%;
      padding: 10px 0;
    }
    .streak-icon { font-size: 40px; margin-bottom: 8px; filter: drop-shadow(0 0 12px rgba(241,89,70,.4)); }
    .streak-num {
      font-size: 48px;
      font-weight: 900;
      letter-spacing: -3px;
      color: var(--tomato);
      line-height: 1;
      text-shadow: 0 0 30px rgba(241,89,70,.35);
    }
    .streak-label { font-size: 10px; color: var(--muted); margin-top: 6px; letter-spacing: 1px; text-transform: uppercase; }
    .streak-total {
      margin-top: 16px;
      padding-top: 14px;
      border-top: 1px solid var(--border);
      font-size: 12px; color: var(--muted);
    }
    .streak-total b { color: var(--cream); font-weight: 700; }

    /* â”€â”€â”€ Goals Tree â”€â”€â”€ */
    .goals-list { display: flex; flex-direction: column; gap: 12px; }
    .goal-row { display: flex; align-items: flex-start; gap: 10px; }
    .goal-tag {
      font-size: 10px;
      font-weight: 700;
      color: var(--tomato);
      min-width: 52px;
      flex-shrink: 0;
    }
    .goal-tag.m { color: var(--sun); }
    .goal-tag.w { color: var(--slate); }
    .goal-text { font-size: 13px; color: var(--muted); line-height: 1.6; }
    .goal-text:empty::before { content: 'â€”'; color: var(--dim); }
    .goals-empty { font-size: 12px; color: var(--dim); padding: 8px 0; }

    /* â”€â”€â”€ Habits (Today) â”€â”€â”€ */
    .habits-prog {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 10px;
    }
    .habits-track {
      height: 4px;
      background: rgba(255,255,255,.06);
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 14px;
    }
    .habits-fill {
      height: 100%;
      border-radius: 2px;
      background: linear-gradient(90deg, var(--tomato), var(--sun));
      transition: width .6s cubic-bezier(.34,1.56,.64,1);
    }
    .cell-habits.complete .habits-fill { background: var(--green); box-shadow: 0 0 16px rgba(61,214,140,.35); }
    .cell-habits.complete { border-color: rgba(61,214,140,.25); box-shadow: inset 0 0 30px rgba(61,214,140,.06); }
    .habit-row {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255,255,255,.04);
      transition: background .2s;
    }
    .habit-row:last-child { border-bottom: none; }
    .habit-row:hover { background: rgba(255,255,255,.02); }
    .habit-check {
      width: 20px;
      height: 20px;
      border-radius: 6px;
      border: 1.5px solid var(--border-hi);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      flex-shrink: 0;
      transition: border-color .2s, background .2s, box-shadow .2s;
    }
    .habit-check.done {
      background: var(--green);
      border-color: var(--green);
      box-shadow: 0 0 10px rgba(61,214,140,.3);
    }
    .habit-name { font-size: 13px; flex: 1; transition: color .2s; }
    .habit-name.done { text-decoration: line-through; color: var(--muted); }
    .habits-empty { font-size: 12px; color: var(--dim); padding: 20px 0; text-align: center; }

    /* â”€â”€â”€ Weekly Chart â”€â”€â”€ */
    .chart-wrap {
      display: flex;
      align-items: flex-end;
      gap: 8px;
      height: 88px;
      padding: 4px 0;
    }
    .chart-bar-col { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px; }
    .chart-bar-wrap { flex: 1; width: 100%; display: flex; align-items: flex-end; justify-content: center; }
    .chart-bar {
      width: 100%;
      max-width: 24px;
      border-radius: 6px 6px 0 0;
      min-height: 4px;
      transition: height .8s cubic-bezier(.34,1.56,.64,1);
      position: relative;
    }
    .chart-bar.low  { background: rgba(255,255,255,.08); }
    .chart-bar.mid  { background: linear-gradient(180deg, var(--sun), rgba(249,194,46,.5)); }
    .chart-bar.hi   { background: linear-gradient(180deg, var(--green), var(--sun)); }
    .chart-bar.p100 { background: var(--green); box-shadow: 0 0 12px rgba(61,214,140,.4); }
    .chart-label { font-size: 9px; color: var(--muted); }
    .chart-pct   { font-size: 9px; font-weight: 700; }
    .chart-empty { font-size: 12px; color: var(--dim); padding: 24px 0; text-align: center; }

    /* â”€â”€â”€ Achievements â”€â”€â”€ */
    .ach-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    .ach-item {
      background: rgba(255,255,255,.03);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px 10px;
      text-align: center;
      transition: border-color .2s, box-shadow .2s;
    }
    .ach-item:hover { border-color: rgba(251,254,251,.1); }
    .ach-item.earned {
      border-color: rgba(249,194,46,.25);
      box-shadow: inset 0 0 20px rgba(249,194,46,.06);
    }
    .ach-item.locked { opacity: .45; filter: grayscale(.7); }
    .ach-icon { font-size: 22px; margin-bottom: 6px; display: block; }
    .ach-item.earned .ach-icon { filter: drop-shadow(0 0 6px rgba(249,194,46,.4)); }
    .ach-name { font-size: 11px; font-weight: 700; margin-bottom: 2px; }
    .ach-desc { font-size: 9px; color: var(--muted); }

    /* â”€â”€â”€ Mini Leaderboard â”€â”€â”€ */
    .lb-list { display: flex; flex-direction: column; gap: 2px; }
    .lb-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 8px;
      transition: background .2s, border-color .2s;
      border: 1px solid transparent;
    }
    .lb-item:hover { background: rgba(255,255,255,.03); }
    .lb-item.me { border-color: rgba(241,89,70,.2); background: rgba(241,89,70,.05); }
    .lb-medal { font-size: 16px; flex-shrink: 0; }
    .lb-info { flex: 1; min-width: 0; }
    .lb-name { font-size: 12px; font-weight: 700; }
    .lb-sub  { font-size: 10px; color: var(--muted); }
    .lb-rate { font-size: 14px; font-weight: 800; color: var(--tomato); }
    .lb-empty { font-size: 12px; color: var(--dim); padding: 20px 0; text-align: center; }

    /* â”€â”€â”€ Challenges Progress â”€â”€â”€ */
    .challenges-list { display: flex; flex-direction: column; gap: 14px; }
    .challenge-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .challenge-title { font-size: 13px; font-weight: 700; color: var(--cream); }
    .challenge-track {
      height: 6px;
      background: rgba(255,255,255,.06);
      border-radius: 3px;
      overflow: hidden;
    }
    .challenge-fill {
      height: 100%;
      border-radius: 3px;
      background: linear-gradient(90deg, var(--sun), var(--green));
      transition: width .5s cubic-bezier(.34,1.56,.64,1);
    }
    .challenge-meta { font-size: 10px; color: var(--muted); }
    .empty { font-size: 12px; color: var(--dim); padding: 12px 0; text-align: center; }

    /* â”€â”€â”€ Journal & Reports (Activity) â”€â”€â”€ */
    .activity-tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }
    .activity-tab {
      padding: 8px 14px;
      font-size: 11px;
      font-weight: 700;
      color: var(--muted);
      cursor: pointer;
      border-radius: 8px 8px 0 0;
      transition: background .2s, color .2s;
    }
    .activity-tab:hover { background: rgba(255,255,255,.04); color: var(--cream); }
    .activity-tab.active { background: rgba(241,89,70,.1); color: var(--tomato); border-bottom: 1px solid var(--surface); margin-bottom: -1px; }
    .activity-pane { display: none; }
    .activity-pane.active { display: block; }
    .activity-list { display: flex; flex-direction: column; gap: 2px; }
    .activity-item {
      padding: 12px 14px;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 12px;
      transition: background .2s, border-color .2s;
    }
    .activity-item:hover { background: rgba(255,255,255,.02); border-color: rgba(251,254,251,.12); }
    .activity-item .date { font-size: 10px; color: var(--muted); margin-bottom: 4px; }
    .activity-item .meta { font-size: 11px; color: var(--slate); margin-top: 6px; }
    .activity-summary { font-size: 11px; color: var(--muted); padding: 10px 0; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESPONSIVE â€” Bento collapses on small screens
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    @media (max-width: 900px) {
      .bento {
        grid-template-columns: 1fr 1fr;
      }
      .cell-identity, .cell-streak { grid-column: span 1; grid-row: span 1; }
      .cell-goals, .cell-habits, .cell-chart, .cell-challenges, .cell-activity, .cell-ach, .cell-lb { grid-column: span 2; }
    }
    @media (max-width: 560px) {
      .bento { grid-template-columns: 1fr; }
      .cell-identity, .cell-streak, .cell-goals, .cell-habits, .cell-chart, .cell-challenges, .cell-activity, .cell-ach, .cell-lb { grid-column: span 1; }
      .streak-num { font-size: 36px; }
      .ach-grid { grid-template-columns: repeat(2, 1fr); }
    }

    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(241,89,70,.2); border-radius: 10px; }
  </style>
</head>
<body>

  <div id="scroll-progress"><div id="scroll-fill"></div></div>

  <!-- â•â•â• LOADING â•â•â• -->
  <div id="screen-load">
    <div class="s-logo">âœ³ï¸</div>
    <div class="s-spin"></div>
    <div class="s-txt">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ÙŠ...</div>
  </div>

  <!-- â•â•â• Ø§Ù†ØªÙ‡Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© â•â•â• -->
  <div id="screen-inv">
    <div class="inv-icon">â°</div>
    <div class="inv-title">Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø±Ø§Ø¨Ø·</div>
    <div class="inv-sub">Ø§Ù„Ø±Ø§Ø¨Ø· ØµØ§Ù„Ø­ 24 Ø³Ø§Ø¹Ø© ÙÙ‚Ø·.<br>Ø§Ø·Ù„Ø¨ Ø±Ø§Ø¨Ø·Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù†.</div>
  </div>

  <!-- â•â•â• BENTO GRID APP â•â•â• -->
  <div id="app">
    <div class="bento">
      <!-- Identity -->
      <div class="cell cell-identity">
        <div class="cell-title">Ø§Ù„Ù‡ÙˆÙŠØ©</div>
        <div class="identity-inner">
          <div class="id-avatar" id="id-avatar">Ù…</div>
          <div class="id-name" id="id-name">â€”</div>
          <div class="id-badge" id="id-badge">ğŸŒ± â€”</div>
          <div class="id-freeze">â„ï¸ Ø±ØµÙŠØ¯ Ø§Ù„ÙØ±ÙŠØ²: <span id="id-freeze">0</span></div>
          <div class="id-meta">
            <span class="id-join" id="id-join">â€”</span>
            <div class="id-warnings zero" id="id-warnings">âš ï¸ Ø¥Ù†Ø°Ø§Ø±Ø§Øª: 0</div>
            <div class="id-reviews">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª: <span id="id-reviews">0/5</span></div>
          </div>
        </div>
      </div>
      <!-- Streak Fire -->
      <div class="cell cell-streak">
        <div class="cell-title">Ø§Ù„Ø³ØªØ±ÙŠÙƒ</div>
        <div class="streak-wrap">
          <div class="streak-icon">ğŸ”¥</div>
          <div class="streak-num" id="streak-num">0</div>
          <div class="streak-label">ÙŠÙˆÙ… Ù…ØªØªØ§Ù„ÙŠ</div>
          <div class="streak-total">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø§Ø¯Ø§Øª: <b id="streak-total">0</b></div>
        </div>
      </div>
      <!-- Goals Tree -->
      <div class="cell cell-goals">
        <div class="cell-title">Ø´Ø¬Ø±Ø© Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</div>
        <div class="goals-list" id="goals-list">
          <div class="goals-empty">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
      </div>
      <!-- Today's Habits -->
      <div class="cell cell-habits" id="cell-habits">
        <div class="cell-title">Ø¹Ø§Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
        <div class="habits-prog"><span>Ø§Ù„ØªÙ‚Ø¯Ù…</span><span id="habits-pct">0%</span></div>
        <div class="habits-track"><div class="habits-fill" id="habits-fill" style="width:0%"></div></div>
        <div id="habits-list"></div>
      </div>
      <!-- Weekly Chart -->
      <div class="cell cell-chart">
        <div class="cell-title">Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
        <div class="chart-wrap" id="chart-wrap">
          <div class="chart-empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>
        </div>
      </div>
      <!-- Challenges Progress -->
      <div class="cell cell-challenges">
        <div class="cell-title">ØªÙ‚Ø¯Ù… Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª</div>
        <div class="challenges-list" id="challenges-list">
          <div class="empty">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
      </div>
      <!-- Journal & Reports -->
      <div class="cell cell-activity">
        <div class="cell-title">Ø§Ù„ÙØ¶ÙØ¶Ø© ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
        <div class="activity-tabs">
          <button type="button" class="activity-tab active" data-pane="reports">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
          <button type="button" class="activity-tab" data-pane="journal">Ø§Ù„ÙØ¶ÙØ¶Ø©</button>
        </div>
        <div id="activity-reports" class="activity-pane active">
          <div class="activity-list" id="activity-reports-list"></div>
          <div class="activity-summary" id="activity-reports-summary"></div>
        </div>
        <div id="activity-journal" class="activity-pane">
          <div class="activity-list" id="activity-journal-list"></div>
          <div class="activity-summary" id="activity-journal-summary"></div>
        </div>
      </div>
      <!-- Achievements -->
      <div class="cell cell-ach">
        <div class="cell-title">Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</div>
        <div class="ach-grid" id="ach-grid"></div>
      </div>
      <!-- Mini Leaderboard -->
      <div class="cell cell-lb">
        <div class="cell-title">Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</div>
        <div class="lb-list" id="lb-list">
          <div class="lb-empty">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CONFIG â€” Token + Achievement definitions
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    const params = new URLSearchParams(location.search);
    const token = params.get('token');

    const ACHIEVEMENTS = [
      { type: 'first_day',      icon: 'ğŸŒ±', name: 'Ø£ÙˆÙ„ Ø®Ø·ÙˆØ©',    desc: 'Ø£ÙˆÙ„ ÙŠÙˆÙ… Ø§Ù„ØªØ²Ø§Ù…' },
      { type: 'week_streak',    icon: 'ğŸ”¥', name: 'Ø£Ø³Ø¨ÙˆØ¹ Ù…Ù„ØªÙ‡Ø¨', desc: '7 Ø£ÙŠØ§Ù… streak' },
      { type: 'month_streak',   icon: 'ğŸ’', name: 'Ù…Ø§Ø³Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…', desc: '30 ÙŠÙˆÙ… streak' },
      { type: 'century_streak', icon: 'ğŸ‘‘', name: 'Ø§Ù„Ù…Ù„Ùƒ',      desc: '100 ÙŠÙˆÙ… streak' },
      { type: 'century_tasks',  icon: 'ğŸ’¯', name: 'Ø§Ù„Ù…Ø¦ÙˆÙŠØ©',    desc: '100 Ø¹Ø§Ø¯Ø© Ù…Ù†Ø¬Ø²Ø©' },
      { type: 'half_k_tasks',   icon: 'â­', name: 'Ù†Ø¬Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²', desc: '500 Ø¹Ø§Ø¯Ø©' },
      { type: 'thousand_tasks', icon: 'ğŸ†', name: 'Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©',   desc: '1000 Ø¹Ø§Ø¯Ø©' },
    ];

    const DAY_NAMES = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
    const AR_MONTHS = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];

    function formatArDate(isoStr) {
      if (!isoStr) return 'â€”';
      const d = new Date(isoStr);
      if (isNaN(d.getTime())) return 'â€”';
      const day = d.getDate();
      const month = AR_MONTHS[d.getMonth()];
      const year = d.getFullYear();
      return `${day} ${month} ${year}`;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCROLL PROGRESS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    window.addEventListener('scroll', () => {
      const el = document.documentElement;
      const pct = (el.scrollTop / (el.scrollHeight - el.clientHeight)) * 100;
      document.getElementById('scroll-fill').style.width = pct + '%';
    }, { passive: true });

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FETCH & RENDER
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function init() {
      if (!token) return showInvalid();
      try {
        const r = await fetch('/api/member/me', {
          headers: { 'x-member-token': token },
        });
        if (!r.ok) return showInvalid();
        const data = await r.json();

        renderIdentity(data.identity);
        renderStreak(data.identity);
        renderGoals(data.goals_tree);
        renderHabits(data.habits_today, data.today_rate);
        renderChart(data.weekly_chart_data);
        renderChallenges(data.challenges_progress);
        renderActivity(data.journal, data.recent_reports);
        renderAchievements(data.achievements);
        fetchLeaderboard();
        setupActivityTabs();
        document.getElementById('screen-load').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        document.title = `Ù…Ø­Ø§ÙˆÙ„Ø§Øª â€” ${data.identity.name}`;
      } catch {
        showInvalid();
      }
    }

    function showInvalid() {
      document.getElementById('screen-load').style.display = 'none';
      document.getElementById('screen-inv').style.display = 'flex';
    }

    function renderIdentity(id) {
      if (!id) return;
      document.getElementById('id-avatar').textContent = (id.name || 'Ù…').charAt(0);
      document.getElementById('id-name').textContent = id.name || 'â€”';
      document.getElementById('id-badge').innerHTML = `${id.rank_emoji || 'ğŸŒ±'} ${id.rank || 'Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ø­Ù„Ø©'}`;
      document.getElementById('id-freeze').textContent = id.streak_freeze ?? 0;
      document.getElementById('id-join').textContent = 'Ø§Ù†Ø¶Ù…: ' + formatArDate(id.created_at);
      const wEl = document.getElementById('id-warnings');
      const wc = id.warning_count ?? 0;
      wEl.textContent = 'âš ï¸ Ø¥Ù†Ø°Ø§Ø±Ø§Øª: ' + wc;
      wEl.className = 'id-warnings ' + (wc > 0 ? 'has' : 'zero');
      document.getElementById('id-reviews').textContent = (id.daily_review_count ?? 0) + '/5';
    }

    function renderStreak(id) {
      if (!id) return;
      document.getElementById('streak-num').textContent = id.streak || 0;
      document.getElementById('streak-total').textContent = id.total_done || 0;
    }

    function renderGoals(tree) {
      const el = document.getElementById('goals-list');
      if (!tree) { el.innerHTML = '<div class="goals-empty">â€”</div>'; return; }
      const y = (tree.yearly && tree.yearly[0]) ? tree.yearly[0].goal_text : '';
      const m = (tree.monthly && tree.monthly.length) ? tree.monthly.map(g => g.goal_text).join(' Â· ') : '';
      const w = (tree.weekly && tree.weekly.length) ? tree.weekly.map(g => g.goal_text).join(' Â· ') : '';
      if (!y && !m && !w) {
        el.innerHTML = '<div class="goals-empty">Ù„Ù… ØªØ­Ø¯Ø¯ Ø£Ù‡Ø¯Ø§ÙØ§Ù‹ Ø¨Ø¹Ø¯</div>';
        return;
      }
      el.innerHTML = `
        <div class="goal-row"><span class="goal-tag">ğŸ¯ Ø³Ù†Ø©</span><span class="goal-text">${y || 'â€”'}</span></div>
        <div class="goal-row"><span class="goal-tag m">ğŸ—“ï¸ Ø´Ù‡Ø±</span><span class="goal-text">${m || 'â€”'}</span></div>
        <div class="goal-row"><span class="goal-tag w">ğŸ“… Ø£Ø³Ø¨ÙˆØ¹</span><span class="goal-text">${w || 'â€”'}</span></div>
      `;
    }

    function renderHabits(habits, rate) {
      const rateNum = rate || 0;
      const listEl = document.getElementById('habits-list');
      const fillEl = document.getElementById('habits-fill');
      const pctEl = document.getElementById('habits-pct');
      const cellEl = document.getElementById('cell-habits');

      pctEl.textContent = rateNum + '%';
      setTimeout(() => { fillEl.style.width = rateNum + '%'; }, 100);
      if (rateNum >= 100 && habits && habits.length) cellEl.classList.add('complete');
      else cellEl.classList.remove('complete');

      if (!habits || !habits.length) {
        listEl.innerHTML = '<div class="habits-empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø§Ø¯Ø§Øª Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</div>';
        return;
      }
      listEl.innerHTML = habits.map(h => `
        <div class="habit-row">
          <div class="habit-check ${h.completed ? 'done' : ''}">${h.completed ? 'âœ“' : ''}</div>
          <div class="habit-name ${h.completed ? 'done' : ''}">${h.name}</div>
        </div>
      `).join('');
    }

    function renderChart(chartData) {
      const wrap = document.getElementById('chart-wrap');
      if (!chartData || !chartData.length) {
        wrap.innerHTML = '<div class="chart-empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>';
        return;
      }
      const todayDay = new Date().getDay();
      wrap.innerHTML = chartData.map(d => {
        const rate = Math.round(d.rate || 0);
        const dayIdx = new Date(d.date).getDay();
        const isToday = dayIdx === todayDay;
        let barClass = 'low';
        if (rate >= 100) barClass = 'p100';
        else if (rate >= 70) barClass = 'hi';
        else if (rate >= 40) barClass = 'mid';
        return `
          <div class="chart-bar-col">
            <div class="chart-pct" style="color:${rate >= 70 ? 'var(--green)' : rate >= 40 ? 'var(--sun)' : 'var(--muted)'}">${rate}%</div>
            <div class="chart-bar-wrap">
              <div class="chart-bar ${barClass}" style="height:${Math.max(rate, 4)}%"></div>
            </div>
            <div class="chart-label">${DAY_NAMES[dayIdx].slice(0, 2)}</div>
          </div>
        `;
      }).join('');
    }

    function renderChallenges(challenges) {
      const el = document.getElementById('challenges-list');
      if (!challenges || !challenges.length) {
        el.innerHTML = '<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­Ø¯ÙŠØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
        return;
      }
      el.innerHTML = challenges.map(c => `
        <div class="challenge-row">
          <div class="challenge-title">${escapeHtml(c.title || 'ØªØ­Ø¯ÙŠ')}</div>
          <div class="challenge-track">
            <div class="challenge-fill" style="width:${Math.min(100, c.percent || 0)}%"></div>
          </div>
          <div class="challenge-meta">${c.daysLogged || 0} Ù…Ù† ${c.totalDays || 0} ÙŠÙˆÙ… Â· ${c.percent || 0}%</div>
        </div>
      `).join('');
    }

    function renderActivity(journal, reports) {
      const reportsList = document.getElementById('activity-reports-list');
      const reportsSummary = document.getElementById('activity-reports-summary');
      const journalList = document.getElementById('activity-journal-list');
      const journalSummary = document.getElementById('activity-journal-summary');

      if (!reports || !reports.length) {
        reportsList.innerHTML = '';
        reportsSummary.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ø­Ø¯ÙŠØ«Ø©.';
        reportsSummary.style.color = 'var(--dim)';
      } else {
        const latest = reports[0];
        const wordCount = latest.word_count != null ? latest.word_count : (latest.content ? latest.content.trim().split(/\s+/).length : 0);
        reportsSummary.textContent = 'Ø¢Ø®Ø± ØªÙ‚Ø±ÙŠØ±: ' + (wordCount || 0) + ' ÙƒÙ„Ù…Ø©.';
        reportsSummary.style.color = 'var(--muted)';
        reportsList.innerHTML = reports.map(r => {
          const d = r.report_date ? formatArDate(r.report_date) : (r.recorded_at ? formatArDate(r.recorded_at) : 'â€”');
          const w = r.word_count != null ? r.word_count : 'â€”';
          return `<div class="activity-item"><div class="date">${d}</div><div class="meta">${w} ÙƒÙ„Ù…Ø©</div></div>`;
        }).join('');
      }

      if (!journal || !journal.length) {
        journalList.innerHTML = '';
        journalSummary.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¯ÙˆÙ†Ø§Øª ÙØ¶ÙØ¶Ø© Ø­Ø¯ÙŠØ«Ø©.';
        journalSummary.style.color = 'var(--dim)';
      } else {
        const latestJ = journal[0];
        const typeLabel = latestJ.type || 'â€”';
        const sentimentLabel = latestJ.sentiment === 'positive' ? 'Ø¥ÙŠØ¬Ø§Ø¨ÙŠ' : latestJ.sentiment === 'negative' ? 'Ø³Ù„Ø¨ÙŠ' : 'Ù…Ø­Ø§ÙŠØ¯';
        journalSummary.textContent = 'Ø¢Ø®Ø± Ù…Ø¯ÙˆÙ†Ø©: Ù†ÙˆØ¹ ' + typeLabel + ' Â· ' + sentimentLabel + '.';
        journalSummary.style.color = 'var(--muted)';
        journalList.innerHTML = journal.map(j => {
          const d = j.date ? formatArDate(j.date) : 'â€”';
          const type = j.type || 'â€”';
          const sent = j.sentiment === 'positive' ? 'Ø¥ÙŠØ¬Ø§Ø¨ÙŠ' : j.sentiment === 'negative' ? 'Ø³Ù„Ø¨ÙŠ' : 'Ù…Ø­Ø§ÙŠØ¯';
          return `<div class="activity-item"><div class="date">${d}</div><div class="meta">${type} Â· ${sent}</div></div>`;
        }).join('');
      }
    }

    function setupActivityTabs() {
      const tabs = document.querySelectorAll('.activity-tab');
      const panes = { reports: document.getElementById('activity-reports'), journal: document.getElementById('activity-journal') };
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const paneId = tab.getAttribute('data-pane');
          if (!paneId || !panes[paneId]) return;
          tabs.forEach(t => t.classList.remove('active'));
          Object.values(panes).forEach(p => { if (p) p.classList.remove('active'); });
          tab.classList.add('active');
          panes[paneId].classList.add('active');
        });
      });
    }

    function escapeHtml(s) {
      const div = document.createElement('div');
      div.textContent = s;
      return div.innerHTML;
    }

    function renderAchievements(earned) {
      const earnedTypes = new Set((earned || []).map(a => a.type));
      const grid = document.getElementById('ach-grid');
      grid.innerHTML = ACHIEVEMENTS.map(a => `
        <div class="ach-item ${earnedTypes.has(a.type) ? 'earned' : 'locked'}">
          <span class="ach-icon">${a.icon}</span>
          <div class="ach-name">${a.name}</div>
          <div class="ach-desc">${a.desc}</div>
        </div>
      `).join('');
    }

    async function fetchLeaderboard() {
      const listEl = document.getElementById('lb-list');
      try {
        const r = await fetch('/api/member/leaderboard', {
          headers: { 'x-member-token': token },
        });
        const data = await r.json();
        const top3 = data.slice(0, 3);
        const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
        if (!top3.length) {
          listEl.innerHTML = '<div class="lb-empty">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ±ØªÙŠØ¨ Ø¨Ø¹Ø¯</div>';
          return;
        }
        listEl.innerHTML = top3.map((l, i) => `
          <div class="lb-item ${l.isMe ? 'me' : ''}">
            <span class="lb-medal">${medals[i] || (i + 1)}</span>
            <div class="lb-info">
              <div class="lb-name">${l.name}${l.isMe ? ' <span style="color:var(--tomato);font-size:10px">(Ø£Ù†Øª)</span>' : ''}</div>
              <div class="lb-sub">ğŸ”¥ ${l.streak} ÙŠÙˆÙ…</div>
            </div>
            <div class="lb-rate">${l.avgRate}%</div>
          </div>
        `).join('');
      } catch {
        listEl.innerHTML = '<div class="lb-empty">ØªØ¹Ø°Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„</div>';
      }
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
