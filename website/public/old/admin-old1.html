<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Ù…Ø­Ø§ÙˆÙ„Ø§Øª â€” Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0C0C0F;--surface:#111115;--raise:#16161C;
  --border:rgba(255,255,255,.06);--border-hi:rgba(255,255,255,.12);
  --text:#E8E8EE;--muted:#55556A;--dim:#888899;
  --orange:#F26450;--yellow:#F5C842;--green:#3DD68C;--red:#F05050;--blue:#5B7EF7;
  --glass:rgba(255,255,255,.038);--glass-hi:rgba(255,255,255,.065);
  --blur:saturate(180%) blur(22px);--blur-sm:saturate(160%) blur(14px);
  --r:14px;--r-lg:20px;--r-xl:28px;
  --glow-o:0 0 60px rgba(242,100,80,.18);
  --ease-s:cubic-bezier(.34,1.56,.64,1);--ease-o:cubic-bezier(.16,1,.3,1);
  --sw:248px;
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%;}
body{font-family:'Tajawal',sans-serif;background:var(--bg);color:var(--text);min-height:100dvh;overflow-x:hidden;-webkit-font-smoothing:antialiased;}
body::after{content:'';position:fixed;inset:0;z-index:9999;pointer-events:none;opacity:.03;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='g'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23g)'/%3E%3C/svg%3E");background-size:180px;}
#ambi{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;}
.blob{position:absolute;border-radius:50%;filter:blur(100px);mix-blend-mode:screen;animation:drift 20s ease-in-out infinite alternate;}
.b1{width:640px;height:640px;background:rgba(242,100,80,.055);top:-200px;right:-180px;animation-duration:22s;}
.b2{width:480px;height:480px;background:rgba(245,200,66,.04);bottom:5%;left:-120px;animation-duration:28s;animation-direction:alternate-reverse;}
.b3{width:360px;height:360px;background:rgba(61,214,140,.03);top:40%;right:30%;animation-duration:18s;}
@keyframes drift{from{transform:translate(0,0) scale(1)}to{transform:translate(40px,60px) scale(1.07)}}

/* LOGIN */
#login{position:fixed;inset:0;z-index:500;display:flex;align-items:center;justify-content:center;padding:24px;background:var(--bg);}
.lbox{width:100%;max-width:380px;animation:popIn .5s var(--ease-s) both;}
@keyframes popIn{from{opacity:0;transform:scale(.92) translateY(20px)}to{opacity:1;transform:none}}
.llogo{width:56px;height:56px;background:var(--orange);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:26px;margin:0 auto 28px;box-shadow:var(--glow-o),0 12px 40px rgba(242,100,80,.3);animation:lp 3s ease-in-out infinite;}
@keyframes lp{0%,100%{box-shadow:var(--glow-o),0 8px 30px rgba(242,100,80,.25)}50%{box-shadow:0 0 80px rgba(242,100,80,.35),0 16px 50px rgba(242,100,80,.3)}}
.ltitle{font-size:28px;font-weight:900;text-align:center;letter-spacing:-.5px;margin-bottom:6px;}
.lsub{font-size:13px;color:var(--muted);text-align:center;margin-bottom:32px;}
.field{width:100%;background:var(--glass);backdrop-filter:var(--blur-sm);-webkit-backdrop-filter:var(--blur-sm);border:1px solid var(--border);border-radius:var(--r);padding:14px 18px;color:var(--text);font-size:16px;font-family:inherit;outline:none;text-align:center;direction:ltr;transition:border-color .2s,box-shadow .2s;margin-bottom:12px;}
.field:focus{border-color:rgba(242,100,80,.5);box-shadow:0 0 0 3px rgba(242,100,80,.1);}
.field::placeholder{color:var(--muted);}
.lbtn{width:100%;padding:15px;background:var(--orange);color:#fff;border:none;border-radius:var(--r);font-size:16px;font-weight:800;font-family:inherit;cursor:pointer;transition:all .2s;box-shadow:var(--glow-o);letter-spacing:.3px;}
.lbtn:hover{opacity:.92;transform:translateY(-2px);}
.lerr{font-size:13px;color:var(--red);text-align:center;margin-top:10px;display:none;animation:shake .4s ease;}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}

/* APP */
#app{display:none;min-height:100dvh;position:relative;z-index:1;}

/* SIDEBAR */
.sb{position:fixed;top:0;right:0;bottom:0;width:var(--sw);background:rgba(14,14,18,.88);backdrop-filter:var(--blur);-webkit-backdrop-filter:var(--blur);border-left:1px solid var(--border);display:flex;flex-direction:column;z-index:100;transition:transform .3s var(--ease-o);}
.sb-hd{padding:24px 20px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;}
.sb-ico{width:36px;height:36px;background:var(--orange);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;box-shadow:0 0 24px rgba(242,100,80,.3);flex-shrink:0;}
.sb-brand{font-size:16px;font-weight:800;letter-spacing:-.3px;}
.sb-ver{font-size:10px;color:var(--orange);opacity:.8;margin-top:1px;}
.sb-nav{flex:1;padding:16px 12px;overflow-y:auto;}
.sb-lbl{font-size:9px;color:var(--muted);letter-spacing:.14em;text-transform:uppercase;padding:0 8px;margin:16px 0 6px;}
.si{display:flex;align-items:center;gap:9px;padding:10px 12px;border-radius:10px;font-size:13px;font-weight:500;color:var(--dim);background:transparent;border:none;width:100%;text-align:right;font-family:inherit;cursor:pointer;transition:all .15s;}
.si:hover{color:var(--text);background:var(--glass);}
.si.on{color:var(--orange);background:rgba(242,100,80,.1);box-shadow:inset 0 0 0 1px rgba(242,100,80,.18);}
.si-i{font-size:15px;width:18px;text-align:center;flex-shrink:0;}
.sb-ft{padding:16px 20px;border-top:1px solid var(--border);}
.sdot{display:flex;align-items:center;gap:10px;}
.dot{width:7px;height:7px;border-radius:50%;background:var(--green);box-shadow:0 0 10px var(--green);animation:bk 2.5s ease-in-out infinite;flex-shrink:0;}
@keyframes bk{0%,100%{opacity:1}50%{opacity:.3}}
.slabel{font-size:13px;font-weight:700;}
.ssub{font-size:11px;color:var(--muted);margin-top:1px;}

/* MAIN */
.main{margin-right:var(--sw);min-height:100dvh;padding:32px 36px;}

/* TOPBAR */
.topbar{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:28px;gap:16px;flex-wrap:wrap;}
.ptitle{font-size:24px;font-weight:800;letter-spacing:-.6px;}
.psub{font-size:12px;color:var(--muted);margin-top:3px;}

/* CARD */
.card{background:var(--glass);backdrop-filter:var(--blur);-webkit-backdrop-filter:var(--blur);border:1px solid var(--border);border-radius:var(--r-lg);position:relative;overflow:hidden;transition:border-color .3s,box-shadow .3s;}
.card::before{content:'';position:absolute;top:0;right:0;left:0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);pointer-events:none;}
.card:hover{border-color:rgba(242,100,80,.18);box-shadow:0 8px 40px rgba(242,100,80,.06);}
.cp{padding:22px 24px;}

/* STATS */
.sgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(155px,1fr));gap:12px;margin-bottom:20px;}
.sc{background:var(--glass);backdrop-filter:var(--blur);-webkit-backdrop-filter:var(--blur);border:1px solid var(--border);border-radius:var(--r-lg);padding:22px 20px 18px;position:relative;overflow:hidden;transition:transform .25s,box-shadow .25s;animation:su .5s var(--ease-o) both;}
.sc::after{content:'';position:absolute;bottom:0;right:0;left:0;height:2px;background:linear-gradient(90deg,transparent,var(--acc,var(--orange)),transparent);opacity:.45;}
.sc:hover{transform:translateY(-3px);box-shadow:0 14px 44px rgba(0,0,0,.2);}
.sc.g{--acc:var(--green)}.sc.r{--acc:var(--red)}.sc.y{--acc:var(--yellow)}.sc.b{--acc:var(--blue)}
@keyframes su{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:none}}
.slb{font-size:11px;color:var(--muted);margin-bottom:10px;letter-spacing:.02em;}
.sn{font-size:38px;font-weight:900;line-height:1;letter-spacing:-1px;}
.ss{font-size:11px;color:var(--muted);margin-top:7px;}

/* TABLE */
.tw{overflow-x:auto;-webkit-overflow-scrolling:touch;}
table{width:100%;border-collapse:collapse;}
th{text-align:right;padding:11px 18px;font-size:10px;color:var(--muted);border-bottom:1px solid var(--border);font-weight:600;white-space:nowrap;letter-spacing:.08em;text-transform:uppercase;}
td{padding:13px 18px;font-size:13px;border-bottom:1px solid rgba(255,255,255,.03);vertical-align:middle;}
tr:last-child td{border-bottom:none;}
tbody tr{transition:background .15s;}
tbody tr:hover td{background:rgba(255,255,255,.025);}

/* BADGE */
.badge{display:inline-flex;align-items:center;padding:3px 10px;border-radius:100px;font-size:11px;font-weight:600;}
.bg{background:rgba(61,214,140,.1);color:var(--green);}
.br{background:rgba(240,80,80,.1);color:var(--red);}
.bo{background:rgba(242,100,80,.1);color:var(--orange);}
.by{background:rgba(245,200,66,.1);color:var(--yellow);}
.bm{background:rgba(255,255,255,.05);color:var(--dim);}

.barr{display:flex;align-items:center;gap:8px;min-width:100px;}
.bt{flex:1;height:3px;background:rgba(255,255,255,.07);border-radius:10px;overflow:hidden;}
.bf{height:100%;background:linear-gradient(90deg,var(--orange),var(--yellow));border-radius:10px;transition:width .8s var(--ease-s);}
.pips{display:flex;gap:4px;}
.pip{width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,.09);}
.pip.on{background:var(--red);box-shadow:0 0 6px rgba(240,80,80,.5);}

/* SEC HEAD */
.sh{display:flex;align-items:center;justify-content:space-between;padding:16px 22px;border-bottom:1px solid var(--border);}
.st{font-size:14px;font-weight:700;}

/* BTN */
.btn{display:inline-flex;align-items:center;gap:7px;padding:9px 18px;border-radius:10px;font-size:12px;font-weight:700;font-family:inherit;border:none;cursor:pointer;transition:all .2s;white-space:nowrap;}
.bp{background:var(--orange);color:#fff;box-shadow:0 0 30px rgba(242,100,80,.2);}
.bp:hover{opacity:.9;transform:translateY(-1px);}
.bgh{background:var(--glass);color:var(--text);border:1px solid var(--border);backdrop-filter:var(--blur-sm);-webkit-backdrop-filter:var(--blur-sm);}
.bgh:hover{border-color:var(--border-hi);background:var(--glass-hi);}
.bsm{padding:6px 14px;font-size:11px;}

/* SEARCH */
.sf{width:100%;background:var(--glass);backdrop-filter:var(--blur-sm);-webkit-backdrop-filter:var(--blur-sm);border:1px solid var(--border);border-radius:var(--r);padding:11px 16px;color:var(--text);font-size:14px;font-family:inherit;outline:none;transition:border-color .2s,box-shadow .2s;margin-bottom:14px;}
.sf:focus{border-color:rgba(242,100,80,.4);box-shadow:0 0 0 3px rgba(242,100,80,.08);}
.sf::placeholder{color:var(--muted);}

/* PAGES */
.pg{display:none;}
.pg.on{display:block;animation:fu .3s var(--ease-o) both;}
@keyframes fu{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}

/* MODAL */
.ov{position:fixed;inset:0;z-index:300;background:rgba(0,0,0,.75);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;padding:20px;animation:fi .2s ease both;}
@keyframes fi{from{opacity:0}to{opacity:1}}
.modal{background:var(--surface);border:1px solid var(--border);border-radius:var(--r-xl);width:100%;max-width:540px;max-height:88dvh;overflow-y:auto;box-shadow:0 40px 100px rgba(0,0,0,.7);animation:popIn .3s var(--ease-s) both;padding:32px;}
.mhd{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:24px;}
.mn{font-size:20px;font-weight:800;letter-spacing:-.4px;}
.ms{font-size:12px;color:var(--muted);margin-top:3px;}
.mclose{background:var(--glass);border:1px solid var(--border);color:var(--dim);width:32px;height:32px;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;transition:all .15s;}
.mclose:hover{color:var(--text);border-color:var(--border-hi);}
.gbox{background:rgba(242,100,80,.06);border:1px solid rgba(242,100,80,.15);border-right:3px solid var(--orange);border-radius:12px;padding:14px 16px;font-size:13px;line-height:1.7;margin-bottom:18px;}
.msgrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:18px;}
.mst{background:var(--glass);border:1px solid var(--border);border-radius:12px;padding:14px;}
.msl{font-size:10px;color:var(--muted);margin-bottom:6px;}
.msv{font-size:22px;font-weight:800;}
.gph{background:#080810;border:1px solid var(--border);border-radius:12px;padding:16px;font-family:'Courier New',monospace;font-size:11.5px;line-height:2.1;overflow-x:auto;}

/* DAILY */
.rcols{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
.rcol{background:var(--glass);backdrop-filter:var(--blur);-webkit-backdrop-filter:var(--blur);border:1px solid var(--border);border-radius:var(--r-lg);overflow:hidden;}
.rhead{padding:14px 18px;font-size:13px;font-weight:700;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px;}
.rd{border-right:3px solid var(--green);}
.rm{border-right:3px solid var(--red);}
.mrow{display:flex;align-items:center;gap:10px;padding:10px 18px;font-size:13px;border-bottom:1px solid rgba(255,255,255,.03);transition:background .15s;}
.mrow:last-child{border-bottom:none;}
.mrow:hover{background:rgba(255,255,255,.02);}
.ava{width:30px;height:30px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:800;background:rgba(242,100,80,.1);color:var(--orange);border:1px solid rgba(242,100,80,.2);}
.ava.mx{background:rgba(240,80,80,.08);color:var(--red);border-color:rgba(240,80,80,.2);}

/* LB */
.lbr{display:flex;align-items:center;gap:14px;padding:14px 22px;border-bottom:1px solid rgba(255,255,255,.03);transition:background .15s;}
.lbr:last-child{border-bottom:none;}
.lbr:hover{background:rgba(255,255,255,.025);}
.lrk{font-size:18px;font-weight:900;width:32px;text-align:center;}
.lnm{flex:1;}
.lnm b{font-size:14px;font-weight:700;display:block;}
.lnm span{font-size:11px;color:var(--muted);}
.lrt{font-size:26px;font-weight:900;color:var(--orange);letter-spacing:-1px;}

/* USER GRID */
.ugrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(185px,1fr));gap:12px;}
.uc{background:var(--glass);backdrop-filter:var(--blur-sm);-webkit-backdrop-filter:var(--blur-sm);border:1px solid var(--border);border-radius:var(--r);padding:18px 16px;cursor:pointer;transition:all .2s;}
.uc:hover{border-color:rgba(242,100,80,.25);transform:translateY(-2px);}
.uc.sel{border-color:var(--orange);background:rgba(242,100,80,.08);box-shadow:0 0 24px rgba(242,100,80,.15);}
.ucn{font-size:14px;font-weight:700;margin-bottom:4px;}
.ucm{font-size:11px;color:var(--muted);}
.lkbox{margin-top:16px;padding:16px 18px;background:rgba(242,100,80,.06);border:1px solid rgba(242,100,80,.18);border-radius:var(--r);display:flex;align-items:center;gap:12px;}
.lkurl{flex:1;font-family:'Courier New',monospace;font-size:12px;color:var(--dim);word-break:break-all;direction:ltr;}

/* LOADING */
.loading{display:flex;align-items:center;gap:10px;padding:44px;justify-content:center;color:var(--muted);font-size:13px;}
.spin{width:18px;height:18px;border:2px solid rgba(255,255,255,.08);border-top-color:var(--orange);border-radius:50%;animation:rot .7s linear infinite;flex-shrink:0;}
@keyframes rot{to{transform:rotate(360deg)}}
.empty{padding:48px;text-align:center;color:var(--muted);font-size:14px;}

/* TOAST */
.toast{position:fixed;bottom:28px;left:28px;z-index:1000;background:var(--raise);border:1px solid var(--border);backdrop-filter:var(--blur);-webkit-backdrop-filter:var(--blur);border-radius:12px;padding:12px 20px;font-size:13px;transform:translateY(90px);opacity:0;transition:all .35s var(--ease-s);pointer-events:none;}
.toast.show{transform:none;opacity:1;}
.toast.ok{border-color:rgba(61,214,140,.3);color:var(--green);}
.toast.er{border-color:rgba(240,80,80,.3);color:var(--red);}

/* MENU FAB */
.fab{display:none;position:fixed;bottom:24px;left:24px;z-index:200;width:52px;height:52px;border-radius:50%;background:var(--orange);color:#fff;border:none;cursor:pointer;font-size:20px;box-shadow:var(--glow-o),0 8px 24px rgba(0,0,0,.4);transition:transform .2s var(--ease-s);align-items:center;justify-content:center;}
.fab:active{transform:scale(.93);}

/* RESPONSIVE */
@media(max-width:820px){
  :root{--sw:0px;}
  .sb{width:280px;transform:translateX(100%);}
  .sb.open{transform:none;box-shadow:-20px 0 60px rgba(0,0,0,.5);}
  .main{margin-right:0;padding:20px 16px 100px;}
  .fab{display:flex;}
  .sgrid{grid-template-columns:1fr 1fr;}
  .rcols{grid-template-columns:1fr;}
  .msgrid{grid-template-columns:1fr 1fr;}
  .modal{padding:24px 20px;}
}
@media(max-width:480px){
  .sgrid{grid-template-columns:1fr 1fr;}
  .sn{font-size:30px;}
  .ptitle{font-size:20px;}
}
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:rgba(242,100,80,.3);border-radius:10px;}
</style>
</head>
<body>
<div id="ambi"><div class="blob b1"></div><div class="blob b2"></div><div class="blob b3"></div></div>

<!-- LOGIN -->
<div id="login">
  <div class="lbox">
    <div class="llogo">âœ³ï¸</div>
    <div class="ltitle">Ù…Ø­Ù€Ø§ÙˆÙ„Ø§Øª</div>
    <div class="lsub">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù†</div>
    <input class="field" type="password" id="pwd" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" autocomplete="current-password">
    <button class="lbtn" id="lbtn" onclick="doLogin()">Ø¯Ø®Ù€ÙˆÙ„ â†’</button>
    <div class="lerr" id="lerr">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙ„Ø·</div>
  </div>
</div>

<!-- APP -->
<div id="app">
  <aside class="sb" id="sb">
    <div class="sb-hd">
      <div class="sb-ico">âœ³ï¸</div>
      <div><div class="sb-brand">Ù…Ø­Ø§ÙˆÙ„Ø§Øª</div><div class="sb-ver">Admin v7.2</div></div>
    </div>
    <nav class="sb-nav">
      <div class="sb-lbl">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
      <button class="si on" onclick="goPage('overview')" id="n-overview"><span class="si-i">ğŸ“Š</span>Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</button>
      <button class="si"    onclick="goPage('members')"  id="n-members"><span class="si-i">ğŸ‘¥</span>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</button>
      <button class="si"    onclick="goPage('lb')"       id="n-lb"><span class="si-i">ğŸ†</span>Ø§Ù„Ù„ÙŠØ¯Ø±Ø¨ÙˆØ±Ø¯</button>
      <div class="sb-lbl">ØªÙ‚Ø§Ø±ÙŠØ±</div>
      <button class="si"    onclick="goPage('daily')"    id="n-daily"><span class="si-i">ğŸ“</span>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</button>
      <button class="si"    onclick="goPage('warns')"    id="n-warns"><span class="si-i">âš ï¸</span>Ø§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª</button>
      <div class="sb-lbl">Ø£Ø¯ÙˆØ§Øª</div>
      <button class="si"    onclick="goPage('links')"    id="n-links"><span class="si-i">ğŸ”—</span>Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</button>
    </nav>
    <div class="sb-ft">
      <div class="sdot">
        <div class="dot"></div>
        <div><div class="slabel">Ù…ØªØµÙ„</div><div class="ssub" id="bst">Ø¬Ø§Ø±ÙŠ...</div></div>
      </div>
    </div>
  </aside>

  <main class="main">
    <!-- OVERVIEW -->
    <div class="pg on" id="p-overview">
      <div class="topbar">
        <div><div class="ptitle">Ù†Ø¸Ù€Ø±Ø© Ø¹Ø§Ù…Ù€Ø©</div><div class="psub" id="ovdate"></div></div>
        <button class="btn bgh" onclick="loadOV()">â†º ØªØ­Ø¯ÙŠØ«</button>
      </div>
      <div class="sgrid" id="sgrid"><div class="loading"><div class="spin"></div></div></div>
      <div class="card" style="padding:0">
        <div class="sh"><div class="st">âš¡ Ø§Ù„Ø£ÙƒØ«Ø± Ù†Ø´Ø§Ø·Ø§Ù‹</div></div>
        <div class="tw"><table><thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø³ØªØ±ÙŠÙƒ</th><th>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th><th>Ø¥Ù†Ø°Ø§Ø±Ø§Øª</th><th>Ø§Ù„ÙŠÙˆÙ…</th></tr></thead>
        <tbody id="ovtb"><tr><td colspan="5"><div class="loading"><div class="spin"></div></div></td></tr></tbody></table></div>
      </div>
    </div>

    <!-- MEMBERS -->
    <div class="pg" id="p-members">
      <div class="topbar"><div><div class="ptitle">Ø§Ù„Ø£Ø¹Ù€Ø¶Ø§Ø¡</div></div><button class="btn bgh" onclick="loadM()">â†º</button></div>
      <input class="sf" placeholder="ğŸ”  Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…..." id="msearch" oninput="filterM()">
      <div class="card" style="padding:0"><div class="tw"><table>
        <thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù‡Ø¯Ù</th><th>Ø³ØªØ±ÙŠÙƒ</th><th>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø¥Ù†Ø°Ø§Ø±Ø§Øª</th><th>Ø§Ù„ÙŠÙˆÙ…</th><th></th></tr></thead>
        <tbody id="mtb"><tr><td colspan="8"><div class="loading"><div class="spin"></div></div></td></tr></tbody>
      </table></div></div>
    </div>

    <!-- LB -->
    <div class="pg" id="p-lb">
      <div class="topbar"><div><div class="ptitle">ğŸ† Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ù€Ø±Ù</div></div><button class="btn bgh" onclick="loadLB()">â†º</button></div>
      <div class="card" style="padding:0" id="lblist"><div class="loading"><div class="spin"></div></div></div>
    </div>

    <!-- DAILY -->
    <div class="pg" id="p-daily">
      <div class="topbar"><div><div class="ptitle">Ø§Ù„ØªÙ‚Ù€Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</div></div><button class="btn bgh" onclick="loadD()">â†º</button></div>
      <div class="sgrid" id="dstats" style="margin-bottom:16px"></div>
      <div class="rcols" id="dcols"><div class="loading"><div class="spin"></div></div></div>
    </div>

    <!-- WARNS -->
    <div class="pg" id="p-warns">
      <div class="topbar"><div><div class="ptitle">âš ï¸ Ø§Ù„Ø¥Ù†Ù€Ø°Ø§Ø±Ø§Øª</div></div><button class="btn bgh" onclick="loadW()">â†º</button></div>
      <div class="card" style="padding:0"><div class="tw"><table>
        <thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª</th><th>Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead>
        <tbody id="wtb"><tr><td colspan="4"><div class="loading"><div class="spin"></div></div></td></tr></tbody>
      </table></div></div>
    </div>

    <!-- LINKS -->
    <div class="pg" id="p-links">
      <div class="topbar"><div><div class="ptitle">ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</div><div class="psub">Ø±Ø§Ø¨Ø· Ù„ÙƒÙ„ Ø¹Ø¶Ùˆ â€” ØµØ§Ù„Ø­ 24 Ø³Ø§Ø¹Ø©</div></div></div>
      <input class="sf" placeholder="ğŸ”  Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…..." id="lsearch" oninput="filterL()">
      <div class="ugrid" id="ugrid"><div class="loading"><div class="spin"></div></div></div>
      <div id="lkres" style="display:none">
        <div class="lkbox"><div class="lkurl" id="lkurl"></div><button class="btn bp bsm" onclick="copyLink()">Ù†Ø³Ø®</button></div>
        <div style="font-size:11px;color:var(--muted);margin-top:8px;padding:0 4px">â° ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø¹Ø¯ 24 Ø³Ø§Ø¹Ø©</div>
      </div>
    </div>
  </main>
</div>

<!-- MODAL -->
<div class="ov" id="mov" style="display:none" onclick="if(event.target===this)this.style.display='none'">
  <div class="modal" onclick="event.stopPropagation()">
    <div class="mhd">
      <div><div class="mn" id="mdn">...</div><div class="ms" id="mds"></div></div>
      <button class="mclose" onclick="document.getElementById('mov').style.display='none'">âœ•</button>
    </div>
    <div class="gbox" id="mdg"></div>
    <div class="msgrid" id="mdst"></div>
    <div style="font-size:11px;color:var(--muted);margin-bottom:8px;font-weight:600;letter-spacing:.06em">Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
    <div class="gph" id="mdgph"></div>
  </div>
</div>

<button class="fab" onclick="toggleSB()">â˜°</button>
<div class="toast" id="toast"></div>

<script>
const A='';let tok=localStorage.getItem('at')||'';let AM=[],AL=[];
addEventListener('DOMContentLoaded',()=>{
  if(tok)autoLogin();
  document.getElementById('pwd').addEventListener('keydown',e=>{if(e.key==='Enter')doLogin();});
  document.getElementById('ovdate').textContent=new Date().toLocaleDateString('ar-EG',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
});
async function autoLogin(){const r=await af('/api/admin/overview').catch(()=>null);if(r?.ok){showApp();loadOV();}else{tok='';localStorage.removeItem('at');}}
async function doLogin(){
  const pwd=document.getElementById('pwd').value,err=document.getElementById('lerr'),btn=document.getElementById('lbtn');
  err.style.display='none';btn.textContent='...';btn.disabled=true;
  const r=await fetch(`${A}/api/admin/login`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({password:pwd})}).catch(()=>null);
  btn.textContent='Ø¯Ø®Ù€ÙˆÙ„ â†’';btn.disabled=false;
  if(r?.ok){const d=await r.json();tok=d.token;localStorage.setItem('at',tok);showApp();loadOV();}
  else{err.style.display='block';err.style.animation='none';requestAnimationFrame(()=>err.style.animation='');document.getElementById('pwd').value='';}
}
function showApp(){document.getElementById('login').style.display='none';document.getElementById('app').style.display='block';health();}
async function af(url,opts={}){return fetch(`${A}${url}`,{...opts,headers:{'Content-Type':'application/json','x-admin-token':tok,...(opts.headers||{})}});}
async function health(){try{const r=await fetch('/api/health'),d=await r.json();document.getElementById('bst').textContent=`${d.users} Ø¹Ø¶Ùˆ Â· ${Math.floor(d.uptime/60)}Ù…`;}catch{document.getElementById('bst').textContent='ØºÙŠØ± Ù…ØªØµÙ„';}}
function goPage(n){
  document.querySelectorAll('.pg').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.si').forEach(s=>s.classList.remove('on'));
  document.getElementById(`p-${n}`).classList.add('on');
  document.getElementById(`n-${n}`).classList.add('on');
  ({overview:loadOV,members:loadM,lb:loadLB,daily:loadD,warns:loadW,links:loadLinks})[n]?.();
  if(window.innerWidth<=820)document.getElementById('sb').classList.remove('open');
}
function toggleSB(){document.getElementById('sb').classList.toggle('open');}

async function loadOV(){
  const[r1,r2]=await Promise.all([af('/api/admin/overview'),af('/api/admin/members')]);
  if(!r1.ok||!r2.ok)return;
  const ov=await r1.json(),mem=await r2.json();
  document.getElementById('sgrid').innerHTML=[
    {l:'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡',v:ov.totalUsers,s:'Ù…Ø³Ø¬Ù„',c:'g'},
    {l:'Ø¹Ù…Ù„ÙˆØ§ Ø§Ù„ØªÙ‚Ø±ÙŠØ±',v:ov.reportedToday,s:`Ù…Ù† ${ov.totalUsers}`,c:''},
    {l:'Ù„Ø³Ù‡ Ù…Ø§ Ø¹Ù…Ù„ÙˆØ´',v:ov.missingToday,s:'Ù…Ø·Ù„ÙˆØ¨',c:'r'},
    {l:'Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',v:ov.avgRate+'%',s:'Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…',c:'y'},
    {l:'Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ØªØ±ÙŠÙƒ',v:ov.avgStreak,s:'ÙŠÙˆÙ…',c:''},
    {l:'Ø°ÙˆÙˆ Ø¥Ù†Ø°Ø§Ø±Ø§Øª',v:ov.withWarnings,s:'Ø¹Ø¶Ùˆ',c:'r'},
  ].map((s,i)=>`<div class="sc ${s.c}" style="animation-delay:${i*.06}s"><div class="slb">${s.l}</div><div class="sn">${s.v}</div><div class="ss">${s.s}</div></div>`).join('');
  const top=[...mem].sort((a,b)=>b.weeklyRate-a.weeklyRate).slice(0,10);
  document.getElementById('ovtb').innerHTML=top.map(m=>`<tr>
    <td><b>${m.name}</b></td>
    <td><div class="barr"><div class="bt"><div class="bf" style="width:${Math.min(m.streak/30*100,100)}%"></div></div><span style="font-size:11px;color:var(--muted)">ğŸ”¥${m.streak}</span></div></td>
    <td><span class="badge ${m.weeklyRate>=70?'bg':m.weeklyRate>=40?'bo':'br'}">${m.weeklyRate}%</span></td>
    <td><div class="pips">${[1,2,3].map(i=>`<div class="pip ${m.warningCount>=i?'on':''}"></div>`).join('')}</div></td>
    <td><span class="badge ${m.reportedToday?'bg':'bm'}">${m.reportedToday?'âœ“':'â€”'}</span></td>
  </tr>`).join('');
}

async function loadM(){const r=await af('/api/admin/members');if(!r.ok)return;AM=await r.json();renderM(AM);}
function renderM(ms){document.getElementById('mtb').innerHTML=ms.length?ms.map(m=>`<tr>
  <td><b>${m.name}</b></td>
  <td style="max-width:150px;color:var(--dim);font-size:12px">${(m.goal||'â€”').slice(0,48)}${(m.goal||'').length>48?'â€¦':''}</td>
  <td>ğŸ”¥ ${m.streak}</td>
  <td><span class="badge ${m.weeklyRate>=70?'bg':m.weeklyRate>=40?'bo':'br'}">${m.weeklyRate}%</span></td>
  <td style="color:var(--muted)">${m.totalDone}</td>
  <td><div class="pips">${[1,2,3].map(i=>`<div class="pip ${m.warningCount>=i?'on':''}"></div>`).join('')}</div></td>
  <td><span class="badge ${m.reportedToday?'bg':'bm'}">${m.reportedToday?'âœ“':'â€”'}</span></td>
  <td><button class="btn bgh bsm" onclick="openM('${m.userId}')">ØªÙØ§ØµÙŠÙ„</button></td>
</tr>`).join(''):'<tr><td colspan="8"><div class="empty">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¶Ø§Ø¡</div></td></tr>';}
function filterM(){const q=document.getElementById('msearch').value.toLowerCase();renderM(AM.filter(m=>m.name.toLowerCase().includes(q)));}

async function openM(id){
  document.getElementById('mov').style.display='flex';
  document.getElementById('mdn').textContent='...';
  document.getElementById('mdst').innerHTML='<div class="loading"><div class="spin"></div></div>';
  const r=await af(`/api/admin/member/${id}`);if(!r.ok)return;
  const{user,analytics}=await r.json();
  document.getElementById('mdn').textContent=user.name;
  document.getElementById('mds').textContent=`${user.gender==='female'?'Ø¹Ø¶ÙˆØ©':'Ø¹Ø¶Ùˆ'} Â· Ø§Ù†Ø¶Ù… ${new Date(user.created_at).toLocaleDateString('ar-EG')}`;
  document.getElementById('mdg').textContent=user.goal||user.bio||'Ù„Ù… ÙŠØ­Ø¯Ø¯ Ù‡Ø¯ÙØ§Ù‹';
  document.getElementById('mdst').innerHTML=`
    <div class="mst"><div class="msl">ğŸ”¥ Ø§Ù„Ø³ØªØ±ÙŠÙƒ</div><div class="msv">${user.days_streak||0} ÙŠÙˆÙ…</div></div>
    <div class="mst"><div class="msl">âœ… Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div><div class="msv">${user.total_done||0}</div></div>
    <div class="mst"><div class="msl">âš ï¸ Ø¥Ù†Ø°Ø§Ø±Ø§Øª</div><div class="msv" style="color:${(user.warning_count||0)>0?'var(--red)':'var(--green)'}">${user.warning_count||0}/3</div></div>
    <div class="mst"><div class="msl">ğŸ“ Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div><div class="msv">${user.daily_review_count||0}/5</div></div>`;
  const dn={Saturday:'SAT',Sunday:'SUN',Monday:'MON',Tuesday:'TUE',Wednesday:'WED',Thursday:'THU',Friday:'FRI'};
  document.getElementById('mdgph').textContent=analytics.weeklyReport?.length
    ?analytics.weeklyReport.map(d=>{const n=new Date(d.date).toLocaleDateString('en-US',{weekday:'long'});const b='â–ˆ'.repeat(Math.floor(d.rate/10))+'â–‘'.repeat(10-Math.floor(d.rate/10));return`${(dn[n]||'DAY').padEnd(4)}  ${b}  ${String(Math.round(d.rate)).padStart(3)}%`;}).join('\n')
    :'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª';
}

async function loadLB(){const r=await af('/api/admin/leaderboard');if(!r.ok)return;const d=await r.json();const m=['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'];
document.getElementById('lblist').innerHTML=d.length?d.map((l,i)=>`<div class="lbr"><div class="lrk">${m[i]||i+1}</div><div class="lnm"><b>${l.name}</b><span>ğŸ”¥ ${l.days_streak||0} Â· ${l.total_done||0} Ø¹Ø§Ø¯Ø©</span></div><div class="lrt">${Math.round(l.avg_rate||0)}%</div></div>`).join(''):'<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>';}

async function loadD(){
  const r=await af('/api/admin/daily-report');if(!r.ok)return;const d=await r.json();
  const p=d.total?Math.round(d.done.length/d.total*100):0;
  document.getElementById('dstats').innerHTML=[{l:'Ø¹Ù…Ù„ÙˆØ§ âœ…',v:d.done.length,c:'g'},{l:'Ù…Ø§ Ø¹Ù…Ù„ÙˆØ´ âŒ',v:d.missing.length,c:'r'},{l:'Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©',v:p+'%',c:'y'}].map((s,i)=>`<div class="sc ${s.c}" style="animation-delay:${i*.06}s"><div class="slb">${s.l}</div><div class="sn">${s.v}</div></div>`).join('');
  document.getElementById('dcols').innerHTML=`
    <div class="rcol"><div class="rhead rd">âœ… Ø¹Ù…Ù„ÙˆØ§ (${d.done.length})</div>${d.done.length?d.done.map(u=>`<div class="mrow"><div class="ava">${u.name[0]}</div>${u.name}</div>`).join(''):'<div class="empty" style="padding:20px">â€”</div>'}</div>
    <div class="rcol"><div class="rhead rm">âŒ Ù„Ø³Ù‡ Ù…Ø§ Ø¹Ù…Ù„ÙˆØ´ (${d.missing.length})</div>${d.missing.length?d.missing.map(u=>`<div class="mrow"><div class="ava mx">${u.name[0]}</div>${u.name}</div>`).join(''):'<div class="empty" style="padding:20px">Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø´Ø§Ø±Ùƒ ğŸ‰</div>'}</div>`;
}

async function loadW(){const r=await af('/api/admin/warnings');if(!r.ok)return;const d=await r.json();
document.getElementById('wtb').innerHTML=d.length?d.sort((a,b)=>b.warningCount-a.warningCount).map(u=>`<tr>
  <td><b>${u.name}</b></td>
  <td><div class="pips">${[1,2,3].map(i=>`<div class="pip ${u.warningCount>=i?'on':''}"></div>`).join('')}<span style="font-size:11px;color:var(--muted);margin-right:8px">${u.warningCount}/3</span></div></td>
  <td>${u.reviewCount||0}/5</td>
  <td><span class="badge ${u.warningCount>=3?'br':u.warningCount>=2?'bo':'by'}">${u.warningCount>=3?'Ø®Ø·Ø±':'ØªØ­Ø°ÙŠØ±'}</span></td>
</tr>`).join(''):'<tr><td colspan="4"><div class="empty">ğŸ‰ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ù†Ø°Ø§Ø±Ø§Øª</div></td></tr>';}

async function loadLinks(){const r=await af('/api/admin/members');if(!r.ok)return;AL=await r.json();renderL(AL);}
function renderL(us){document.getElementById('ugrid').innerHTML=us.map(u=>`<div class="uc" onclick="genLink('${u.userId}',this)"><div class="ucn">${u.name}</div><div class="ucm">ğŸ”¥ ${u.streak} Â· ${u.weeklyRate}%</div></div>`).join('');}
function filterL(){const q=document.getElementById('lsearch').value.toLowerCase();renderL(AL.filter(u=>u.name.toLowerCase().includes(q)));}
async function genLink(id,card){
  document.querySelectorAll('.uc').forEach(c=>c.classList.remove('sel'));card.classList.add('sel');
  document.getElementById('lkres').style.display='block';document.getElementById('lkurl').textContent='Ø¬Ø§Ø±ÙŠ...';
  const r=await af('/api/admin/generate-member-link',{method:'POST',body:JSON.stringify({userId:id})});
  if(!r.ok)return;const d=await r.json();document.getElementById('lkurl').textContent=d.url;
}
function copyLink(){navigator.clipboard.writeText(document.getElementById('lkurl').textContent).then(()=>toast('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·','ok'));}

function toast(msg,t='ok'){const el=document.getElementById('toast');el.textContent=msg;el.className=`toast ${t} show`;setTimeout(()=>el.classList.remove('show'),3000);}
</script>
</body>
</html>
