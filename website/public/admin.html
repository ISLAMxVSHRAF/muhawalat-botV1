<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Ù…Ø­Ø§ÙˆÙ„Ø§Øª â€” ØºØ±ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</title>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       IDENTITY â€” Neo-Brutalism + Data-heavy Dashboard
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root {
      --bg:      #0C090D;
      --surface: #0F0C10;
      --raise:   #141118;
      --slate:   #7286A0;
      --tomato:  #F15946;
      --sun:     #F9C22E;
      --green:   #3DD68C;
      --red:     #F04747;
      --cream:   #FBFEFB;
      --border:  rgba(251,254,251,.08);
      --border-hi: rgba(251,254,251,.14);
      --muted:   rgba(251,254,251,.35);
      --dim:     rgba(251,254,251,.12);
    }
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'IBM Plex Sans Arabic', sans-serif;
      background: var(--bg);
      color: var(--cream);
      min-height: 100dvh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
    }
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      opacity: .03;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TERMINAL LOGIN â€” Secure Entry
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #login {
      position: fixed;
      inset: 0;
      z-index: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      background: var(--bg);
    }
    #login::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, transparent 0%, rgba(241,89,70,.02) 50%, transparent 100%);
      pointer-events: none;
    }
    .term-box {
      width: 100%;
      max-width: 400px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 36px 32px;
      box-shadow: 0 0 0 1px rgba(251,254,251,.03), 0 24px 48px rgba(0,0,0,.4);
      animation: termIn .4s cubic-bezier(.16,1,.3,1) both;
    }
    @keyframes termIn {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: none; }
    }
    .term-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 28px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }
    .term-logo {
      width: 44px;
      height: 44px;
      background: var(--tomato);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      box-shadow: 0 0 24px rgba(241,89,70,.25);
    }
    .term-title { font-size: 18px; font-weight: 800; letter-spacing: -.4px; }
    .term-sub  { font-size: 11px; color: var(--muted); margin-top: 2px; }
    .term-label {
      font-size: 10px;
      color: var(--slate);
      letter-spacing: 1.5px;
      text-transform: uppercase;
      margin-bottom: 8px;
    }
    .term-input {
      width: 100%;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 14px 16px;
      color: var(--cream);
      font-size: 15px;
      font-family: inherit;
      outline: none;
      direction: ltr;
      text-align: left;
      transition: border-color .2s, box-shadow .2s;
      margin-bottom: 20px;
    }
    .term-input:focus {
      border-color: rgba(241,89,70,.4);
      box-shadow: 0 0 0 3px rgba(241,89,70,.08);
    }
    .term-input::placeholder { color: var(--dim); }
    .term-btn {
      width: 100%;
      padding: 14px;
      background: var(--tomato);
      color: var(--cream);
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: border-color .2s, box-shadow .2s;
      border: 1px solid transparent;
    }
    .term-btn:hover {
      border-color: rgba(251,254,251,.1);
      box-shadow: 0 0 24px rgba(241,89,70,.2);
    }
    .term-err {
      font-size: 12px;
      color: var(--red);
      text-align: center;
      margin-top: 12px;
      display: none;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOP NAV â€” No Sidebar
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #app { display: none; min-height: 100dvh; position: relative; z-index: 1; }
    .topnav {
      position: sticky;
      top: 0;
      z-index: 200;
      background: rgba(12,9,13,.92);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border-bottom: 1px solid var(--border);
      padding: 0 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      min-height: 56px;
      flex-wrap: wrap;
      gap: 12px;
    }
    .topnav-brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .topnav-icon {
      width: 32px;
      height: 32px;
      background: var(--tomato);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      box-shadow: 0 0 16px rgba(241,89,70,.25);
    }
    .topnav-name { font-size: 15px; font-weight: 800; letter-spacing: -.3px; }
    .topnav-live {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 9px;
      font-weight: 700;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--green);
    }
    .topnav-live-dot {
      width: 6px;
      height: 6px;
      background: var(--green);
      border-radius: 50%;
      animation: liveDot 2s ease-in-out infinite;
    }
    @keyframes liveDot {
      0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(61,214,140,.4); }
      50%      { opacity: .8; box-shadow: 0 0 0 6px rgba(61,214,140,0); }
    }
    .topnav-tabs {
      display: flex;
      gap: 2px;
      align-items: center;
    }
    .topnav-tab {
      padding: 8px 14px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      color: var(--muted);
      background: transparent;
      border: 1px solid transparent;
      cursor: pointer;
      font-family: inherit;
      transition: border-color .2s, color .2s, box-shadow .2s;
      text-decoration: none;
    }
    .topnav-tab:hover { color: var(--cream); }
    .topnav-tab.on {
      color: var(--tomato);
      border-color: rgba(241,89,70,.25);
      box-shadow: inset 0 0 20px rgba(241,89,70,.06);
    }
    .topnav-out {
      padding: 6px 12px;
      font-size: 11px;
      color: var(--muted);
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 6px;
      cursor: pointer;
      font-family: inherit;
      transition: border-color .2s, color .2s;
    }
    .topnav-out:hover { color: var(--cream); border-color: var(--border-hi); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAIN CONTENT
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .main { max-width: 1400px; margin: 0 auto; padding: 24px; }

    /* â”€â”€â”€ Live Telemetry â”€â”€â”€ */
    .telemetry {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 12px;
      margin-bottom: 28px;
    }
    .tel-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      transition: border-color .25s, box-shadow .25s;
    }
    .tel-card:hover {
      border-color: var(--border-hi);
      box-shadow: inset 0 0 30px rgba(241,89,70,.03);
    }
    .tel-card.danger { border-color: rgba(240,71,71,.2); }
    .tel-card.success { border-color: rgba(61,214,140,.15); }
    .tel-label { font-size: 10px; color: var(--muted); letter-spacing: 1px; margin-bottom: 8px; }
    .tel-num { font-size: 32px; font-weight: 900; letter-spacing: -2px; line-height: 1; }
    .tel-sub  { font-size: 10px; color: var(--muted); margin-top: 6px; }

    /* â”€â”€â”€ Section Head â”€â”€â”€ */
    .sec-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 16px;
    }
    .sec-title { font-size: 16px; font-weight: 800; letter-spacing: -.4px; }
    .sec-meta { font-size: 11px; color: var(--muted); }

    /* â”€â”€â”€ Members Grid (Data Cards) â”€â”€â”€ */
    .members-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 14px;
    }
    .member-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 18px;
      cursor: pointer;
      transition: border-color .25s, box-shadow .25s;
    }
    .member-card:hover {
      border-color: var(--border-hi);
      box-shadow: inset 0 0 24px rgba(241,89,70,.04);
    }
    .member-card.alert {
      border-color: rgba(240,71,71,.35);
      animation: alertPulse 2.5s ease-in-out infinite;
    }
    @keyframes alertPulse {
      0%, 100% { box-shadow: inset 0 0 0 0 rgba(240,71,71,0); }
      50%      { box-shadow: inset 0 0 30px rgba(240,71,71,.06); }
    }
    .mc-top { display: flex; align-items: flex-start; justify-content: space-between; gap: 10px; margin-bottom: 12px; }
    .mc-ava {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: rgba(241,89,70,.12);
      border: 1px solid rgba(241,89,70,.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 800;
      color: var(--tomato);
      flex-shrink: 0;
    }
    .mc-name { font-size: 15px; font-weight: 800; flex: 1; min-width: 0; }
    .mc-warn {
      display: flex;
      gap: 4px;
      align-items: center;
    }
    .mc-warn-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--border);
    }
    .mc-warn-dot.on { background: var(--red); box-shadow: 0 0 8px rgba(240,71,71,.4); }
    .mc-bar-wrap {
      height: 4px;
      background: rgba(255,255,255,.08);
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 10px;
    }
    .mc-bar-fill {
      height: 100%;
      border-radius: 2px;
      background: linear-gradient(90deg, var(--tomato), var(--sun));
      transition: width .6s cubic-bezier(.34,1.56,.64,1);
    }
    .mc-meta { display: flex; justify-content: space-between; font-size: 11px; color: var(--muted); }
    .mc-today { font-size: 10px; }
    .mc-today.yes { color: var(--green); }
    .mc-today.no { color: var(--muted); }

    /* â”€â”€â”€ Search â”€â”€â”€ */
    .search-inp {
      width: 100%;
      max-width: 320px;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 14px;
      color: var(--cream);
      font-size: 13px;
      font-family: inherit;
      outline: none;
      transition: border-color .2s, box-shadow .2s;
      margin-bottom: 16px;
    }
    .search-inp:focus {
      border-color: rgba(241,89,70,.35);
      box-shadow: 0 0 0 3px rgba(241,89,70,.06);
    }
    .search-inp::placeholder { color: var(--dim); }

    /* â”€â”€â”€ Reports & Daily â”€â”€â”€ */
    .reports-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    @media (max-width: 700px) { .reports-row { grid-template-columns: 1fr; } }
    .report-col {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }
    .report-col-head {
      padding: 14px 18px;
      font-size: 12px;
      font-weight: 700;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .report-col-head.done { border-right: 3px solid var(--green); }
    .report-col-head.miss { border-right: 3px solid var(--red); }
    .report-name {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 18px;
      font-size: 13px;
      border-bottom: 1px solid rgba(255,255,255,.04);
      transition: background .15s;
    }
    .report-name:last-child { border-bottom: none; }
    .report-name:hover { background: rgba(255,255,255,.02); }
    .report-ava {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: rgba(61,214,140,.15);
      border: 1px solid rgba(61,214,140,.25);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 800;
      color: var(--green);
      flex-shrink: 0;
    }
    .report-ava.miss { background: rgba(240,71,71,.1); border-color: rgba(240,71,71,.2); color: var(--red); }
    .challenge-cta {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background: var(--tomato);
      color: var(--cream);
      border: none;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      margin-top: 16px;
      transition: border-color .2s, box-shadow .2s;
      border: 1px solid transparent;
    }
    .challenge-cta:hover {
      border-color: rgba(251,254,251,.1);
      box-shadow: 0 0 28px rgba(241,89,70,.25);
    }

    /* â”€â”€â”€ Warnings List (cards, no table) â”€â”€â”€ */
    .warn-list { display: flex; flex-direction: column; gap: 10px; }
    .warn-card {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
      padding: 14px 18px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      transition: border-color .2s;
    }
    .warn-card.danger { border-color: rgba(240,71,71,.3); }
    .warn-card .name { font-size: 14px; font-weight: 700; }
    .warn-card .meta { font-size: 11px; color: var(--muted); }
    .warn-pips { display: flex; gap: 4px; }
    .warn-pip { width: 8px; height: 8px; border-radius: 50%; background: var(--border); }
    .warn-pip.on { background: var(--red); }

    /* â”€â”€â”€ Links (user cards) â”€â”€â”€ */
    .links-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
    .link-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 14px;
      cursor: pointer;
      transition: border-color .2s, box-shadow .2s;
    }
    .link-card:hover { border-color: rgba(241,89,70,.25); box-shadow: inset 0 0 16px rgba(241,89,70,.04); }
    .link-card.sel { border-color: var(--tomato); box-shadow: inset 0 0 20px rgba(241,89,70,.08); }
    .link-card-name { font-size: 13px; font-weight: 700; margin-bottom: 4px; }
    .link-card-meta { font-size: 10px; color: var(--muted); }
    .link-result {
      display: none;
      margin-top: 16px;
      padding: 16px;
      background: rgba(241,89,70,.06);
      border: 1px solid rgba(241,89,70,.2);
      border-radius: 10px;
    }
    .link-url {
      font-size: 11px;
      color: var(--cream);
      word-break: break-all;
      margin-bottom: 12px;
      font-family: 'Consolas', monospace;
      direction: ltr;
      text-align: left;
    }

    /* â”€â”€â”€ Leaderboard (list, no table) â”€â”€â”€ */
    .lb-list { display: flex; flex-direction: column; gap: 2px; }
    .lb-row {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 18px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      transition: background .2s, border-color .2s;
    }
    .lb-row:hover { background: rgba(255,255,255,.02); }
    .lb-rank { font-size: 18px; font-weight: 900; width: 32px; text-align: center; }
    .lb-info { flex: 1; }
    .lb-info b { font-size: 14px; font-weight: 700; display: block; }
    .lb-info span { font-size: 11px; color: var(--muted); }
    .lb-rate { font-size: 20px; font-weight: 900; color: var(--tomato); }

    /* â”€â”€â”€ Overview Top List (cards) â”€â”€â”€ */
    .ov-cards { display: flex; flex-direction: column; gap: 10px; }
    .ov-card {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 14px 18px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      transition: border-color .2s;
    }
    .ov-card:hover { border-color: var(--border-hi); }
    .ov-card .name { font-size: 14px; font-weight: 700; }
    .ov-card .bar-wrap { flex: 1; height: 6px; background: rgba(255,255,255,.08); border-radius: 3px; overflow: hidden; }
    .ov-card .bar-fill { height: 100%; background: linear-gradient(90deg, var(--tomato), var(--sun)); border-radius: 3px; transition: width .6s; }
    .ov-card .rate { font-size: 12px; font-weight: 700; min-width: 36px; text-align: left; }
    .ov-card .pips { display: flex; gap: 4px; }
    .ov-card .pip { width: 6px; height: 6px; border-radius: 50%; background: var(--border); }
    .ov-card .pip.on { background: var(--red); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODAL â€” Glassmorphism + Neo-brutalism
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .modal-overlay {
      position: fixed;
      inset: 0;
      z-index: 400;
      background: rgba(0,0,0,.7);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn .2s ease both;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .modal-box {
      width: 100%;
      max-width: 480px;
      max-height: 88dvh;
      overflow-y: auto;
      background: var(--surface);
      border: 1px solid var(--border-hi);
      border-radius: 16px;
      padding: 28px;
      box-shadow: 0 0 0 1px rgba(251,254,251,.04), 0 32px 64px rgba(0,0,0,.5);
      animation: modalIn .3s cubic-bezier(.16,1,.3,1) both;
    }
    @keyframes modalIn {
      from { opacity: 0; transform: scale(.96) translateY(16px); }
      to   { opacity: 1; transform: none; }
    }
    .modal-head {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .modal-name { font-size: 18px; font-weight: 800; letter-spacing: -.4px; }
    .modal-sub { font-size: 11px; color: var(--muted); margin-top: 4px; }
    .modal-close {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      transition: border-color .2s, color .2s;
    }
    .modal-close:hover { color: var(--cream); border-color: var(--border-hi); }
    .modal-goal {
      background: rgba(241,89,70,.06);
      border: 1px solid rgba(241,89,70,.15);
      border-right: 3px solid var(--tomato);
      border-radius: 8px;
      padding: 12px 16px;
      font-size: 12px;
      line-height: 1.65;
      margin-bottom: 20px;
    }
    .modal-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    .modal-stat {
      background: rgba(255,255,255,.04);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
    }
    .modal-stat-l { font-size: 9px; color: var(--muted); letter-spacing: .5px; margin-bottom: 4px; }
    .modal-stat-v { font-size: 18px; font-weight: 800; }
    .modal-actions-title { font-size: 11px; color: var(--muted); margin-bottom: 10px; letter-spacing: .5px; }
    .modal-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .modal-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 16px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--cream);
      transition: border-color .2s, box-shadow .2s;
    }
    .modal-btn:hover { border-color: var(--border-hi); box-shadow: inset 0 0 16px rgba(255,255,255,.03); }
    .modal-btn.danger { border-color: rgba(240,71,71,.3); color: var(--red); }
    .modal-btn.danger:hover { box-shadow: inset 0 0 16px rgba(240,71,71,.08); }
    .modal-btn.primary { background: var(--tomato); border-color: var(--tomato); color: var(--cream); }
    .modal-btn.primary:hover { box-shadow: 0 0 20px rgba(241,89,70,.25); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOAST â€” Restyled
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      z-index: 600;
      padding: 12px 20px;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
      font-family: 'IBM Plex Sans Arabic', sans-serif;
      background: var(--surface);
      border: 1px solid var(--border);
      box-shadow: 0 0 0 1px rgba(251,254,251,.04), 0 16px 40px rgba(0,0,0,.4);
      backdrop-filter: blur(20px);
      transform: translateY(80px);
      opacity: 0;
      transition: transform .3s cubic-bezier(.16,1,.3,1), opacity .3s;
    }
    #toast.show { transform: translateY(0); opacity: 1; }
    #toast.ok { border-color: rgba(61,214,140,.25); color: var(--green); }
    #toast.err { border-color: rgba(240,71,71,.25); color: var(--red); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGES + EMPTY + LOADING
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .pg { display: none; }
    .pg.on { display: block; animation: pgIn .25s ease both; }
    @keyframes pgIn { from { opacity: 0; } to { opacity: 1; } }
    .empty { padding: 32px; text-align: center; color: var(--dim); font-size: 13px; }
    .loading { padding: 32px; text-align: center; }
    .spin {
      width: 28px;
      height: 28px;
      border: 2px solid var(--border);
      border-top-color: var(--tomato);
      border-radius: 50%;
      animation: spin .8s linear infinite;
      margin: 0 auto 12px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CHEAT-SHEET MODAL â€” Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª (Admin Commands)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .modal-box.cheatsheet { max-width: 640px; }
    .cheatsheet-title { font-size: 10px; font-weight: 700; letter-spacing: 1.5px; color: var(--muted); margin: 20px 0 10px; text-transform: uppercase; }
    .cheatsheet-title:first-of-type { margin-top: 0; }
    .cmd-row-wrap {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      padding: 10px 14px;
      background: #08080c;
      border: 1px solid var(--border);
      border-radius: 8px;
      margin-bottom: 8px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 12px;
    }
    .cmd-row-wrap .cmd-text { flex: 1; min-width: 0; color: rgba(251,254,251,.9); word-break: break-all; }
    .cmd-row-wrap .cmd-desc { font-size: 11px; color: var(--muted); font-family: 'IBM Plex Sans Arabic', sans-serif; width: 100%; margin-top: 6px; padding-right: 0; }
    .cmd-row-wrap .cmd-copy {
      flex-shrink: 0;
      padding: 5px 10px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-size: 11px;
      font-family: inherit;
      cursor: pointer;
      transition: border-color .2s, color .2s;
    }
    .cmd-row-wrap .cmd-copy:hover { color: var(--cream); border-color: var(--border-hi); }
    .cmd-row-wrap .cmd-copy.copied { color: var(--green); border-color: rgba(61,214,140,.3); }
  </style>
</head>
<body>

  <div id="toast"></div>

  <!-- â•â•â• TERMINAL LOGIN â•â•â• -->
  <div id="login">
    <div class="term-box">
      <div class="term-header">
        <div class="term-logo">ğŸ‘‘</div>
        <div>
          <div class="term-title">ØºØ±ÙØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</div>
          <div class="term-sub">Secure Terminal Entry</div>
        </div>
      </div>
      <div class="term-label">PASSWORD</div>
      <input class="term-input" type="password" id="pw" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
      <button class="term-btn" onclick="doLogin()">Ø¯Ø®ÙˆÙ„</button>
      <div class="term-err" id="lerr">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©</div>
    </div>
  </div>

  <!-- â•â•â• APP â•â•â• -->
  <div id="app">
    <nav class="topnav">
      <div class="topnav-brand">
        <div class="topnav-icon">âœ³ï¸</div>
        <div>
          <div class="topnav-name">Ù…Ø­Ø§ÙˆÙ„Ø§Øª</div>
          <div class="topnav-live"><span class="topnav-live-dot"></span> LIVE</div>
        </div>
      </div>
      <div class="topnav-tabs">
        <button class="topnav-tab on" data-page="overview">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</button>
        <button class="topnav-tab" data-page="members">Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</button>
        <button class="topnav-tab" data-page="daily">ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</button>
        <button class="topnav-tab" data-page="warns">Ø§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª</button>
        <button class="topnav-tab" data-page="links">Ø±ÙˆØ§Ø¨Ø·</button>
        <button class="topnav-tab" data-page="lb">Ø§Ù„Ù„ÙŠØ¯Ø±Ø¨ÙˆØ±Ø¯</button>
        <button class="topnav-tab" id="btn-cheatsheet" type="button">ğŸ“‹ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</button>
        <a href="/" class="topnav-tab" style="text-decoration:none">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <button class="topnav-out" onclick="doLogout()">Ø®Ø±ÙˆØ¬</button>
      </div>
    </nav>

    <main class="main">
      <!-- â•â•â• LIVE TELEMETRY (shared) â•â•â• -->
      <div class="telemetry" id="telemetry">
        <div class="tel-card"><div class="tel-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</div><div class="tel-num" id="t-total">â€”</div><div class="tel-sub" id="t-date">â€”</div></div>
        <div class="tel-card success"><div class="tel-label">Ø£ÙƒÙ…Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</div><div class="tel-num" id="t-done">â€”</div><div class="tel-sub">Ø¹Ø¶Ùˆ</div></div>
        <div class="tel-card danger"><div class="tel-label">Ù„Ù… ÙŠÙƒÙ…Ù„</div><div class="tel-num" id="t-miss">â€”</div><div class="tel-sub">Ù…Ø·Ù„ÙˆØ¨</div></div>
        <div class="tel-card"><div class="tel-label">Ø¥Ù†Ø°Ø§Ø±Ø§Øª Ù†Ø´Ø·Ø©</div><div class="tel-num" id="t-warn">â€”</div><div class="tel-sub">Ø¹Ø¶Ùˆ</div></div>
      </div>

      <!-- â•â•â• OVERVIEW â•â•â• -->
      <div class="pg on" id="p-overview">
        <div class="sec-head">
          <div class="sec-title">Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
          <button class="modal-btn primary" onclick="loadAll()">â†» ØªØ­Ø¯ÙŠØ«</button>
        </div>
        <div class="ov-cards" id="ov-list">
          <div class="loading"><div class="spin"></div><div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div>
        </div>
      </div>

      <!-- â•â•â• MEMBERS â•â•â• -->
      <div class="pg" id="p-members">
        <div class="sec-head">
          <div class="sec-title">Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</div>
          <button class="modal-btn primary" onclick="loadMembers()">â†» ØªØ­Ø¯ÙŠØ«</button>
        </div>
        <input class="search-inp" id="msearch" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ..." oninput="filterMembers()">
        <div class="members-grid" id="members-grid">
          <div class="loading"><div class="spin"></div></div>
        </div>
      </div>

      <!-- â•â•â• DAILY REPORT + CHALLENGES â•â•â• -->
      <div class="pg" id="p-daily">
        <div class="sec-head">
          <div class="sec-title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ§Øª</div>
          <button class="modal-btn primary" onclick="loadDaily()">â†» ØªØ­Ø¯ÙŠØ«</button>
        </div>
        <div class="reports-row" id="daily-cols">
          <div class="loading"><div class="spin"></div></div>
        </div>
        <button class="challenge-cta" onclick="showToast('Ø£Ù†Ø´Ø¦ Ø§Ù„ØªØ­Ø¯ÙŠ Ù…Ù† Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ ğŸ¯', 'ok')">ğŸ¯ Ø¥Ù†Ø´Ø§Ø¡ ØªØ­Ø¯Ù Ø¬Ø¯ÙŠØ¯</button>
      </div>

      <!-- â•â•â• WARNINGS â•â•â• -->
      <div class="pg" id="p-warns">
        <div class="sec-head">
          <div class="sec-title">Ø§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª</div>
          <button class="modal-btn primary" onclick="loadWarns()">â†» ØªØ­Ø¯ÙŠØ«</button>
        </div>
        <div class="warn-list" id="warn-list">
          <div class="loading"><div class="spin"></div></div>
        </div>
      </div>

      <!-- â•â•â• LINKS â•â•â• -->
      <div class="pg" id="p-links">
        <div class="sec-head">
          <div class="sec-title">Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</div>
        </div>
        <input class="search-inp" id="lsearch" placeholder="ğŸ” Ø§Ø¨Ø­Ø«..." oninput="filterLinks()">
        <div class="links-grid" id="links-grid">
          <div class="loading"><div class="spin"></div></div>
        </div>
        <div class="link-result" id="link-result">
          <div class="link-url" id="link-url"></div>
          <button class="modal-btn primary" onclick="copyLink()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
        </div>
      </div>

      <!-- â•â•â• LEADERBOARD â•â•â• -->
      <div class="pg" id="p-lb">
        <div class="sec-head">
          <div class="sec-title">Ø§Ù„Ù„ÙŠØ¯Ø±Ø¨ÙˆØ±Ø¯</div>
          <button class="modal-btn primary" onclick="loadLB()">â†» ØªØ­Ø¯ÙŠØ«</button>
        </div>
        <div class="lb-list" id="lb-list">
          <div class="loading"><div class="spin"></div></div>
        </div>
      </div>
    </main>
  </div>

  <!-- â•â•â• CHEAT-SHEET MODAL (Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª) â•â•â• -->
  <div class="modal-overlay" id="cheatsheet-modal" style="display:none" onclick="if(event.target===this)closeCheatsheet()">
    <div class="modal-box cheatsheet" onclick="event.stopPropagation()">
      <div class="modal-head">
        <div>
          <div class="modal-name">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</div>
          <div class="modal-sub">Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ â€” Ø§Ù†Ø³Ø® ÙˆØ§Ù„ØµÙ‚</div>
        </div>
        <button class="modal-close" onclick="closeCheatsheet()">âœ•</button>
      </div>
      <div class="cheatsheet-body">
        <div class="cheatsheet-title">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù…</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/setup</span>
          <button type="button" class="cmd-copy" data-cmd="/setup">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ (Ø³Ø±ÙŠØ¹ / Ù…Ø®ØµØµ / ÙŠØ¯ÙˆÙŠ)</span>
        </div>
        <div class="cheatsheet-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/recreate_dashboard @user</span>
          <button type="button" class="cmd-copy" data-cmd="/recreate_dashboard @user">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø¹Ø¶Ùˆ</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/create_thread @user</span>
          <button type="button" class="cmd-copy" data-cmd="/create_thread @user">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³Ø§Ø­Ø© (Thread) Ù„Ø¹Ø¶Ùˆ</span>
        </div>
        <div class="cheatsheet-title">Ø§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/warn @user [reason]</span>
          <button type="button" class="cmd-copy" data-cmd="/warn @user ">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¥Ø¹Ø·Ø§Ø¡ Ø¥Ù†Ø°Ø§Ø± Ù„Ø¹Ø¶Ùˆ (Ø§Ù„Ø³Ø¨Ø¨ Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/remove_warn @user</span>
          <button type="button" class="cmd-copy" data-cmd="/remove_warn @user">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø±ÙØ¹ Ø¥Ù†Ø°Ø§Ø± Ù…Ù† Ø¹Ø¶Ùˆ</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/clear_warns @user</span>
          <button type="button" class="cmd-copy" data-cmd="/clear_warns @user">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ù…Ø³Ø­ ÙƒÙ„ Ø¥Ù†Ø°Ø§Ø±Ø§Øª Ø¹Ø¶Ùˆ</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/warnings @user</span>
          <button type="button" class="cmd-copy" data-cmd="/warnings @user">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø¥Ù†Ø°Ø§Ø±Ø§Øª Ø¹Ø¶Ùˆ</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/warnings_all</span>
          <button type="button" class="cmd-copy" data-cmd="/warnings_all">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† Ù„Ø¯ÙŠÙ‡Ù… Ø¥Ù†Ø°Ø§Ø±Ø§Øª</span>
        </div>
        <div class="cheatsheet-title">Ø§Ù„Ù€ Timeout</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/timeout_list</span>
          <button type="button" class="cmd-copy" data-cmd="/timeout_list">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ Timeouts Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</span>
        </div>
        <div class="cheatsheet-title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/daily_done</span>
          <button type="button" class="cmd-copy" data-cmd="/daily_done">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ù…Ù† Ø£ØªÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/daily_missing</span>
          <button type="button" class="cmd-copy" data-cmd="/daily_missing">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ù…Ù† Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/sync_reports thread_id: date:</span>
          <button type="button" class="cmd-copy" data-cmd="/sync_reports thread_id: date:">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ‚Ø§Ø±ÙŠØ± ÙŠØ¯ÙˆÙŠØ§Ù‹ (Ø­Ø¯Ø¯ thread_id ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®)</span>
        </div>
        <div class="cheatsheet-title">Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/schedule_add channel: time: content: [title:] [repeat:] [media:]</span>
          <button type="button" class="cmd-copy" data-cmd="/schedule_add channel: time: content: ">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¬Ø¯ÙˆÙ„Ø© Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/schedule_list</span>
          <button type="button" class="cmd-copy" data-cmd="/schedule_list">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø¬Ø¯ÙˆÙ„Ø©</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/schedule_pause id:</span>
          <button type="button" class="cmd-copy" data-cmd="/schedule_pause id:">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª Ù„Ø±Ø³Ø§Ù„Ø©</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/schedule_resume id:</span>
          <button type="button" class="cmd-copy" data-cmd="/schedule_resume id:">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø§Ø³ØªØ¦Ù†Ø§Ù Ø±Ø³Ø§Ù„Ø© Ù…ÙˆÙ‚ÙˆÙØ©</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/schedule_delete id:</span>
          <button type="button" class="cmd-copy" data-cmd="/schedule_delete id:">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø­Ø°Ù Ø±Ø³Ø§Ù„Ø© Ù…Ø¬Ø¯ÙˆÙ„Ø©</span>
        </div>
        <div class="cheatsheet-title">Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/autorespond_add trigger: response: [channels:] [match:]</span>
          <button type="button" class="cmd-copy" data-cmd="/autorespond_add trigger: response: ">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¥Ø¶Ø§ÙØ© Ø±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/autorespond_list</span>
          <button type="button" class="cmd-copy" data-cmd="/autorespond_list">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/autorespond_toggle id:</span>
          <button type="button" class="cmd-copy" data-cmd="/autorespond_toggle id:">Ù†Ø³Ø®</button>
          <span class="cmd-desc">ØªÙØ¹ÙŠÙ„ Ø£Ùˆ ØªØ¹Ø·ÙŠÙ„ Ø±Ø¯</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/autorespond_delete id:</span>
          <button type="button" class="cmd-copy" data-cmd="/autorespond_delete id:">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø­Ø°Ù Ø±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
        </div>
        <div class="cheatsheet-title">Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/challenge_create title: channel: description: duration: keyword: [image:]</span>
          <button type="button" class="cmd-copy" data-cmd="/challenge_create title: channel: description: duration: keyword: ">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¥Ù†Ø´Ø§Ø¡ ØªØ­Ø¯ÙŠ Ø¬Ø¯ÙŠØ¯</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/challenge_stats id:</span>
          <button type="button" class="cmd-copy" data-cmd="/challenge_stats id:">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØªØ­Ø¯ÙŠ</span>
        </div>
        <div class="cheatsheet-title">Ø§Ø®ØªØ¨Ø§Ø±</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/test_morning</span>
          <button type="button" class="cmd-copy" data-cmd="/test_morning">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø§Ø®ØªØ¨Ø§Ø± Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØµØ¨Ø§Ø­ ÙÙˆØ±Ø§Ù‹</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/test_evening</span>
          <button type="button" class="cmd-copy" data-cmd="/test_evening">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø³Ø§Ø¡ ÙÙˆØ±Ø§Ù‹</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/test_reset</span>
          <button type="button" class="cmd-copy" data-cmd="/test_reset">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/test_weekly</span>
          <button type="button" class="cmd-copy" data-cmd="/test_weekly">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù„ÙŠØ¯Ø±Ø¨ÙˆØ±Ø¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</span>
        </div>
        <div class="cheatsheet-title">ØµÙŠØ§Ù†Ø©</div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/debug_status</span>
          <button type="button" class="cmd-copy" data-cmd="/debug_status">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/db_backup</span>
          <button type="button" class="cmd-copy" data-cmd="/db_backup">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
        </div>
        <div class="cmd-row-wrap">
          <span class="cmd-text">/help</span>
          <button type="button" class="cmd-copy" data-cmd="/help">Ù†Ø³Ø®</button>
          <span class="cmd-desc">Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø£ÙˆØ§Ù…Ø±</span>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â• MEMBER MODAL â•â•â• -->
  <div class="modal-overlay" id="modal" style="display:none" onclick="if(event.target===this)closeModal()">
    <div class="modal-box">
      <div class="modal-head">
        <div>
          <div class="modal-name" id="md-name">â€”</div>
          <div class="modal-sub" id="md-sub">â€”</div>
        </div>
        <button class="modal-close" onclick="closeModal()">âœ•</button>
      </div>
      <div class="modal-goal" id="md-goal">â€”</div>
      <div class="modal-stats" id="md-stats"></div>
      <div class="modal-actions-title">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</div>
      <div class="modal-actions">
        <button class="modal-btn danger" id="md-btn-warn" onclick="addWarning()">âš ï¸ Ø¥Ø¹Ø·Ø§Ø¡ Ø¥Ù†Ø°Ø§Ø±</button>
        <button class="modal-btn" id="md-btn-remove" onclick="removeWarning()">â†© Ø±ÙØ¹ Ø¥Ù†Ø°Ø§Ø±</button>
        <button class="modal-btn primary" onclick="copyMemberLink()">ğŸ”— Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</button>
      </div>
    </div>
  </div>

  <script>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       STATE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    let TOKEN = '';
    let MEMBERS = [];
    let LINKS_LIST = [];
    let currentMemberId = null;

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       AUTH
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    document.getElementById('pw').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });

    async function doLogin() {
      const pw = document.getElementById('pw').value;
      const r = await fetch('/api/admin/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ password: pw })
      });
      if (r.ok) {
        const d = await r.json();
        TOKEN = d.token;
        document.getElementById('login').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        loadAll();
      } else {
        const el = document.getElementById('lerr');
        el.style.display = 'block';
        setTimeout(() => el.style.display = 'none', 3200);
      }
    }

    function doLogout() {
      TOKEN = '';
      document.getElementById('app').style.display = 'none';
      document.getElementById('login').style.display = 'flex';
      document.getElementById('pw').value = '';
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       API
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    function api(url, opts = {}) {
      return fetch(url, {
        ...opts,
        headers: { 'Content-Type': 'application/json', 'x-admin-token': TOKEN, ...(opts.headers || {}) }
      });
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       NAV
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    document.querySelectorAll('.topnav-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        if (this.tagName === 'A') return;
        const page = this.dataset.page;
        if (!page) return;
        document.querySelectorAll('.topnav-tab').forEach(t => t.classList.remove('on'));
        document.querySelectorAll('.pg').forEach(p => p.classList.remove('on'));
        this.classList.add('on');
        document.getElementById('p-' + page).classList.add('on');
        if (page === 'members') loadMembers();
        else if (page === 'daily') loadDaily();
        else if (page === 'warns') loadWarns();
        else if (page === 'links') loadLinks();
        else if (page === 'lb') loadLB();
      });
    });

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TELEMETRY + OVERVIEW
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function loadAll() {
      const [rOv, rMem] = await Promise.all([api('/api/admin/overview'), api('/api/admin/members')]);
      if (!rOv.ok || !rMem.ok) return;
      const ov = await rOv.json();
      const mem = await rMem.json();
      MEMBERS = mem;

      document.getElementById('t-total').textContent = ov.totalUsers;
      document.getElementById('t-date').textContent = ov.date || new Date().toLocaleDateString('ar-EG');
      document.getElementById('t-done').textContent = ov.reportedToday;
      document.getElementById('t-miss').textContent = ov.missingToday;
      document.getElementById('t-warn').textContent = ov.withWarnings;

      const top = [...mem].sort((a, b) => (b.weeklyRate || 0) - (a.weeklyRate || 0)).slice(0, 10);
      document.getElementById('ov-list').innerHTML = top.length
        ? top.map(m => `
          <div class="ov-card">
            <span class="name">${m.name}</span>
            <div class="bar-wrap"><div class="bar-fill" style="width:${Math.min(m.weeklyRate || 0, 100)}%"></div></div>
            <span class="rate" style="color:${m.weeklyRate >= 70 ? 'var(--green)' : m.weeklyRate >= 40 ? 'var(--sun)' : 'var(--muted)'}">${m.weeklyRate}%</span>
            <div class="pips">${[1,2,3].map(i => `<div class="pip ${(m.warningCount||0) >= i ? 'on' : ''}"></div>`).join('')}</div>
            <span style="font-size:11px;color:var(--muted)">${m.reportedToday ? 'âœ…' : 'â€”'}</span>
          </div>`).join('')
        : '<div class="empty">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¶Ø§Ø¡</div>';
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MEMBERS GRID
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function loadMembers() {
      const r = await api('/api/admin/members');
      if (!r.ok) return;
      MEMBERS = await r.json();
      renderMembers(MEMBERS);
    }

    function renderMembers(list) {
      const grid = document.getElementById('members-grid');
      if (!list.length) {
        grid.innerHTML = '<div class="empty" style="grid-column:1/-1">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¶Ø§Ø¡</div>';
        return;
      }
      grid.innerHTML = list.map(m => {
        const alert = (m.warningCount || 0) >= 3;
        return `
          <div class="member-card ${alert ? 'alert' : ''}" onclick="openModal('${m.userId}')" data-user-id="${m.userId}">
            <div class="mc-top">
              <div class="mc-ava">${(m.name || 'Ù…').charAt(0)}</div>
              <div class="mc-name">${m.name}</div>
              <div class="mc-warn">
                ${[1,2,3].map(i => `<div class="mc-warn-dot ${(m.warningCount||0) >= i ? 'on' : ''}"></div>`).join('')}
              </div>
            </div>
            <div class="mc-bar-wrap"><div class="mc-bar-fill" style="width:${Math.min(m.weeklyRate || 0, 100)}%"></div></div>
            <div class="mc-meta">
              <span>ğŸ”¥ ${m.streak || 0} ÙŠÙˆÙ… Â· ${m.weeklyRate || 0}%</span>
              <span class="mc-today ${m.reportedToday ? 'yes' : 'no'}">${m.reportedToday ? 'âœ… Ø§Ù„ÙŠÙˆÙ…' : 'â€”'}</span>
            </div>
          </div>`;
      }).join('');
    }

    function filterMembers() {
      const q = document.getElementById('msearch').value.toLowerCase();
      renderMembers(MEMBERS.filter(m => (m.name || '').toLowerCase().includes(q)));
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODAL + QUICK ACTIONS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function openModal(userId) {
      currentMemberId = userId;
      document.getElementById('modal').style.display = 'flex';
      document.getElementById('md-name').textContent = '...';
      document.getElementById('md-sub').textContent = '';
      document.getElementById('md-goal').textContent = '...';
      document.getElementById('md-stats').innerHTML = '<div class="loading"><div class="spin"></div></div>';

      const r = await api('/api/admin/member/' + userId);
      if (!r.ok) {
        showToast('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ§ØµÙŠÙ„', 'err');
        return;
      }
      const { user, analytics } = await r.json();
      document.getElementById('md-name').textContent = user.name;
      document.getElementById('md-sub').textContent = `${user.gender === 'female' ? 'Ø¹Ø¶ÙˆØ©' : 'Ø¹Ø¶Ùˆ'} Â· Ø§Ù†Ø¶Ù… ${new Date(user.created_at).toLocaleDateString('ar-EG')}`;
      document.getElementById('md-goal').textContent = user.goal || user.bio || 'Ù„Ù… ÙŠØ­Ø¯Ø¯ Ù‡Ø¯ÙØ§Ù‹';
      const w = user.warning_count || 0;
      document.getElementById('md-stats').innerHTML = `
        <div class="modal-stat"><div class="modal-stat-l">ğŸ”¥ Ø§Ù„Ø³ØªØ±ÙŠÙƒ</div><div class="modal-stat-v">${user.days_streak || 0} ÙŠÙˆÙ…</div></div>
        <div class="modal-stat"><div class="modal-stat-l">âœ… Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div><div class="modal-stat-v">${user.total_done || 0}</div></div>
        <div class="modal-stat"><div class="modal-stat-l">âš ï¸ Ø¥Ù†Ø°Ø§Ø±Ø§Øª</div><div class="modal-stat-v" style="color:${w > 0 ? 'var(--red)' : 'var(--green)'}">${w}/3</div></div>
        <div class="modal-stat"><div class="modal-stat-l">ğŸ“ Ù…Ø±Ø§Ø¬Ø¹Ø§Øª</div><div class="modal-stat-v">${user.daily_review_count || 0}/5</div></div>`;
      document.getElementById('md-btn-remove').style.display = w > 0 ? 'inline-flex' : 'none';
    }

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
      currentMemberId = null;
    }

    async function addWarning() {
      if (!currentMemberId) return;
      const r = await api('/api/admin/warning/add', { method: 'POST', body: JSON.stringify({ userId: currentMemberId, reason: 'Ù…Ø®Ø§Ù„ÙØ© Ø§Ù„Ø´Ø±ÙˆØ·' }) });
      if (!r.ok) {
        const d = await r.json().catch(() => ({}));
        showToast(d.error || 'ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ù†Ø°Ø§Ø±', 'err');
        return;
      }
      showToast('ØªÙ… Ø¥Ø¹Ø·Ø§Ø¡ Ø¥Ù†Ø°Ø§Ø±', 'ok');
      openModal(currentMemberId);
      loadMembers();
      loadAll();
    }

    async function removeWarning() {
      if (!currentMemberId) return;
      const r = await api('/api/admin/warning/remove', { method: 'POST', body: JSON.stringify({ userId: currentMemberId }) });
      if (!r.ok) {
        const d = await r.json().catch(() => ({}));
        showToast(d.error || 'ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„Ø¥Ù†Ø°Ø§Ø±', 'err');
        return;
      }
      showToast('ØªÙ… Ø±ÙØ¹ Ø¥Ù†Ø°Ø§Ø±', 'ok');
      openModal(currentMemberId);
      loadMembers();
      loadAll();
    }

    async function copyMemberLink() {
      if (!currentMemberId) return;
      const r = await api('/api/admin/generate-member-link', { method: 'POST', body: JSON.stringify({ userId: currentMemberId }) });
      if (!r.ok) return;
      const d = await r.json();
      navigator.clipboard.writeText(d.url).then(() => {
        showToast('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯', 'ok');
      });
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DAILY REPORT
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function loadDaily() {
      const r = await api('/api/admin/daily-report');
      if (!r.ok) return;
      const d = await r.json();
      const total = d.total || 0;
      const done = d.done || [];
      const missing = d.missing || [];
      const pct = total ? Math.round((done.length / total) * 100) : 0;
      document.getElementById('t-done').textContent = done.length;
      document.getElementById('t-miss').textContent = missing.length;
      document.getElementById('daily-cols').innerHTML = `
        <div class="report-col">
          <div class="report-col-head done">âœ… Ø¹Ù…Ù„ÙˆØ§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± (${done.length})</div>
          ${done.length ? done.map(u => `<div class="report-name"><div class="report-ava">${(u.name||'ØŸ').charAt(0)}</div>${u.name}</div>`).join('') : '<div class="empty">â€”</div>'}
        </div>
        <div class="report-col">
          <div class="report-col-head miss">âŒ Ù„Ù… ÙŠÙƒÙ…Ù„ÙˆØ§ (${missing.length})</div>
          ${missing.length ? missing.map(u => `<div class="report-name"><div class="report-ava miss">${(u.name||'ØŸ').charAt(0)}</div>${u.name}</div>`).join('') : '<div class="empty">Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø´Ø§Ø±Ùƒ ğŸ‰</div>'}
        </div>`;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       WARNINGS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function loadWarns() {
      const r = await api('/api/admin/warnings');
      if (!r.ok) return;
      const list = await r.json();
      const sorted = list.sort((a, b) => (b.warningCount || 0) - (a.warningCount || 0));
      document.getElementById('warn-list').innerHTML = sorted.length
        ? sorted.map(u => `
          <div class="warn-card ${(u.warningCount||0) >= 3 ? 'danger' : ''}">
            <div><span class="name">${u.name}</span><div class="meta">Ù…Ø±Ø§Ø¬Ø¹Ø§Øª: ${u.reviewCount || 0}/5</div></div>
            <div class="warn-pips">${[1,2,3].map(i => `<div class="warn-pip ${(u.warningCount||0) >= i ? 'on' : ''}"></div>`).join('')}
              <span style="font-size:11px;color:var(--muted);margin-right:8px">${u.warningCount || 0}/3</span>
            </div>
          </div>`).join('')
        : '<div class="empty">ğŸ‰ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ù†Ø°Ø§Ø±Ø§Øª</div>';
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LINKS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function loadLinks() {
      const r = await api('/api/admin/members');
      if (!r.ok) return;
      LINKS_LIST = await r.json();
      renderLinks(LINKS_LIST);
    }

    function renderLinks(list) {
      document.getElementById('links-grid').innerHTML = list.map(u => `
        <div class="link-card" onclick="genLink('${u.userId}', this)">
          <div class="link-card-name">${u.name}</div>
          <div class="link-card-meta">ğŸ”¥ ${u.streak || 0} Â· ${u.weeklyRate || 0}%</div>
        </div>`).join('');
    }

    function filterLinks() {
      const q = document.getElementById('lsearch').value.toLowerCase();
      renderLinks(LINKS_LIST.filter(u => (u.name || '').toLowerCase().includes(q)));
    }

    async function genLink(userId, card) {
      document.querySelectorAll('.link-card').forEach(c => c.classList.remove('sel'));
      card.classList.add('sel');
      document.getElementById('link-result').style.display = 'block';
      document.getElementById('link-url').textContent = 'Ø¬Ø§Ø±ÙŠ...';
      const r = await api('/api/admin/generate-member-link', { method: 'POST', body: JSON.stringify({ userId }) });
      if (!r.ok) return;
      const d = await r.json();
      document.getElementById('link-url').textContent = d.url;
    }

    function copyLink() {
      const url = document.getElementById('link-url').textContent;
      if (!url || url === 'Ø¬Ø§Ø±ÙŠ...') return;
      navigator.clipboard.writeText(url).then(() => showToast('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·', 'ok'));
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LEADERBOARD
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    async function loadLB() {
      const r = await api('/api/admin/leaderboard');
      if (!r.ok) return;
      const d = await r.json();
      const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
      document.getElementById('lb-list').innerHTML = d.length
        ? d.map((l, i) => `
          <div class="lb-row">
            <div class="lb-rank">${medals[i] || (i + 1)}</div>
            <div class="lb-info"><b>${l.name}</b><span>ğŸ”¥ ${l.days_streak || 0} ÙŠÙˆÙ… Â· ${l.total_done || 0} Ø¹Ø§Ø¯Ø©</span></div>
            <div class="lb-rate">${Math.round(l.avg_rate || 0)}%</div>
          </div>`).join('')
        : '<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>';
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CHEAT-SHEET (Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    document.getElementById('btn-cheatsheet').addEventListener('click', openCheatsheet);
    function openCheatsheet() {
      document.getElementById('cheatsheet-modal').style.display = 'flex';
    }
    function closeCheatsheet() {
      document.getElementById('cheatsheet-modal').style.display = 'none';
    }
    document.querySelectorAll('.cmd-row-wrap .cmd-copy').forEach(function(btn) {
      btn.addEventListener('click', function() {
        var row = this.closest('.cmd-row-wrap');
        var text = row ? row.querySelector('.cmd-text') : null;
        var cmd = text ? text.textContent.trim() : (this.getAttribute('data-cmd') || '');
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(cmd).then(function() {
            btn.textContent = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®';
            btn.classList.add('copied');
            setTimeout(function() { btn.textContent = 'Ù†Ø³Ø®'; btn.classList.remove('copied'); }, 2000);
          });
        } else {
          btn.textContent = 'ØªÙ…';
          btn.classList.add('copied');
          setTimeout(function() { btn.textContent = 'Ù†Ø³Ø®'; btn.classList.remove('copied'); }, 1500);
        }
      });
    });

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOAST
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    function showToast(msg, type = 'ok') {
      const el = document.getElementById('toast');
      el.textContent = msg;
      el.className = type + ' show';
      setTimeout(() => el.classList.remove('show'), 3200);
    }
  </script>
</body>
</html>
